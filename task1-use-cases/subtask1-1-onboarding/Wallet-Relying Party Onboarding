## Use Case: UC-01 Wallet-Relying Party Onboarding

### Basic Information
- **Use Case ID**: UC-01
- **Title**: Wallet-Relying Party Onboarding
- **Category**: Onboarding
- **Priority**: [High | Medium | Low]
- **Complexity**: [Simple | Medium | Complex]
- **Version**: 1.0
- **Last Updated**: 14/10/2025

### Actors
- **Primary Actor**: Wallet-Relying Party
- **Secondary Actors**: Registrar, Access Certificate Authority, Provider of Registration Certificate
- **Stakeholders**: Supervisory Body, Data Protection Authority, Member State, EU Commission

### Goal
- **Business Goal**: To register Relying Parties that intend to rely on European Digital Identity Wallets (‘wallets’) for the provision of digital public or private services (ref. [IA Commission Implementing Regulation (EU) 2025/848](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=OJ:L_202500848), Recital 1)
- **Technical Goal**: To establish a harmonised, secure, and interoperable framework for the registration, certification, and lifecycle management of wallet-relying parties, enabling trusted interaction between wallet solutions and other parties involved.
- **Success Criteria**: [Measurable success indicators]

### Preconditions
- Member State must have established at least one National Register of Wallet- Relying Parties (ref. [IA](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=OJ:L_202500848) / Art. 3 / National registers);
- Member State must have designated at least one Registrar (ref. [[IA] / Art. 3 / National registers](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=OJ:L_202500848));
- Member State must have authorised at least one Certificate Authority to issue Wallet-Relying Party Access Certificates (ref. [[IA] / Art. 7 / Wallet-relying party access certificates]((https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=OJ:L_202500848))); 
- Member State must have authorised at least one Certificate Authority to issue Wallet-Relying Party Registration Certificates (ref. [[IA] / Art. 8 / Wallet-relying party registration certificates]((https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=OJ:L_202500848)));
- Member State must have published one or more national Registration Policies, including or reusing existing sectoral or national registration policies (ref. [[IA] / Art. 4 / Registration pollicies]((https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=OJ:L_202500848)));
- The Europen Commission must be notified about the Registrar, to Access Certificate Authority and the Provider of Registration Certificate.

### Main Flow (Happy Path)

**Phase 1: Administrative Onboarding**

*Reference*
- [[IA] Art. 3. National registers](https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202500848#:~:text=that%20Member%20State.-,Article%C2%A03,-National%20registers)
- [[IA] Art. 5. Information to be provided to the national registers](https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202500848#art_5:~:text=Information%20to%20be%20provided%20to%20the%20national%20registers)
- [[IA] Art. 4. Registration policies](https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202500848#art_5:~:text=Article%C2%A04-,Registration%20policies,-1.%C2%A0%C2%A0%C2%A0Member%20States)
- [[IA] Art. 6. Registration processes](https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202500848#art_5:~:text=Article%C2%A06-,Registration%20processes,-1.%C2%A0%C2%A0%C2%A0Registrars%20shall)
- [[IA] Annex I | Wallet Relying Party Information](https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202500848#anx_I:~:text=Information%20regarding%20wallet%2Drelying%20parties)
- [[IA] Annex II | 2. Requirements on the single common API referred to in Articole 3](https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202500848#anx_II:~:text=REQUIREMENTS%20ON%20THE%20SINGLE%20COMMON%20API%20REFERRED%20TO%20IN%20ARTICLE%C2%A03)
- [[IA] Annex III | Source of documentary evidence for the verification of entitlements of wallet-relying parties referred to in Article 6](https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202500848#anx_III:~:text=Source%20of%20documentary%20evidence%20for%20the%20verification%20of%20entitlements%20of%20wallet%2Drelying%20parties%20referred%20to%20in%20Article%C2%A06)

*1.1 Registration Application*
* The Wallet-Relying Party submits to the National Register the registration application, providing at least the information set out in Annex I; 
* The Registrar receives the registration application.

*1.2 Registration Review*
* The Registrar verifies the registration application;
* If needed, the Registrar requests additional information (the application status becomes "pending");
* If required, the Wallet-Relying Party sends additional information.

*1.3 Registration Confirmation*
* The Registrar validates or rejects the registration application (the application status becomes "accepted or rejected");
* The Wallet-Relying Party receives positive or negative feedback on registration application.

**Phase 2: Technical Onboarding**

*Reference*
- [[IA] Art. 7. Wallet-relying party access certificates](https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202500848#art_7:~:text=Article%C2%A07-,Wallet%2Drelying%20party%20access%20certificates,-1.%C2%A0%C2%A0%C2%A0Member%20States)
- [[IA] Art. 8. Wallet-relying party registration certificates](https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202500848#art_8:~:text=Article%C2%A08-,Wallet%2Drelying%20party%20registration%20certificates,-1.%C2%A0%C2%A0%C2%A0Member%20States)
- [[IA] Art. 10. Record keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202500848#art_10:~:text=Article%C2%A010-,Record%20keeping,-Registrars%20shall%20keep)
- [[IA] Annex II | 2. Requirements on the single common API referred to in Articole 3](https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202500848#anx_II:~:text=REQUIREMENTS%20ON%20THE%20SINGLE%20COMMON%20API%20REFERRED%20TO%20IN%20ARTICLE%C2%A03)
- [[IA] Annex IV | Requirements for wallet-relying party access certificates referred to in Article 7](https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202500848#anx_IV:~:text=Requirements%20for%20wallet%2Drelying%20party%20access%20certificates%20referred%20to%20in%20Article%C2%A07)
- [[IA] Annex V | Requirements for wallet-relying party registration certificates referred to in Article 8](https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202500848#anx_V:~:text=Requirements%20for%20wallet%2Drelying%20party%20registration%20certificates%20referred%20to%20in%20Article%C2%A08)
- [[IA] Topic X / Relying Party Registration / 2.2 Draft CIR on Relying Party registration](https://github.com/eu-digital-identity-wallet/eudi-doc-architecture-and-reference-framework/blob/main/docs/discussion-topics/x-relying-party-registration.md)

*2.1 Access Certificate Request*
* The Wallet-Relying Party requests the Access Certificate;
* The Access Certificate Authority receives the Access Certificate request.

*2.2 Access Certificate Request Review*
* The Access Certificate Authority verifies the identity and any other attributes of the wallet-relying party;
* The Access Certificate Authority checks the valid registration status and information coherency within a National Register in which that Wallet-Relying Party is established.

*2.3 Access Certificate Issuance*
* The Access Certificate Authority issues the Access Certificate and logs the Access Certificate issued;
* The Registrar keeps records of the issuance of Wallet-Relying Party Access Certificate for 10 years and publishes its history within a common REST API (JSON format).

*2.4 Registration Certificate Request*
* The Wallet-Relying Party requests the Registration Certificate;
* The Provider of Registration Certificate receives the Registration Certificate request.

*2.5 Registration Certificate Request Review*
* The Provider of Registration Certificate verifies the identity and any other attributes of the Wallet-Relying Party;
* The Provider of Registration Certificate checks the valid registration status, the information coherency within a National Register in which that Wallet-Relying Party is established and the validity of Wallet-Relying Party Access Certificate.

*2.6 Registration Certificate Issuance*
* The Provider of Registration Certificate issues the Registration Certificate and logs the Registration Certificate issued;
* The Registrar keeps records of the issuance of Wallet-Relying Party Registration Certificate for 10 years and publishes its history within a common REST API (JSON format).

**Phase 3: Post-Onboarding**

*Reference*
- [[IA] Art. 5. Information to be provided to the national registers](https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202500848#art_5:~:text=Information%20to%20be%20provided%20to%20the%20national%20registers)
- [[IA] Art. 9. Suspension and cancellation of registration](https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202500848#art_9:~:text=Suspension%20and%20cancellation%20of%20registration)
- [[IA] Annex IV | Requirements for wallet-relying party access certificates referred to in Article 7](https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202500848#anx_IV:~:text=Requirements%20for%20wallet%2Drelying%20party%20access%20certificates%20referred%20to%20in%20Article%C2%A07)
- [[IA] Annex V | Requirements for wallet-relying party registration certificates referred to in Article 8](https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202500848#anx_V:~:text=Requirements%20for%20wallet%2Drelying%20party%20registration%20certificates%20referred%20to%20in%20Article%C2%A08)

*3.1 Registration Update*
* When needed, the Wallet-Relying Party updates information;
* The Registrar receives the updated information and reissues the certificate.

*3.2 Registration Monitoring*
* The Registrar monitors continuosly;
* The Access Certificate Authority monitors continuosly and automatically;
* The Provider of Registration Certificate monitors continuosly and automatically;
* Supervisory Body monitors continuosly;
* Data Protection Authority monitors continuosly.

*3.3 Registration Suspension / Cancellation*

If:
* If needed, the National Registrar conducts a proportionality assessment;
* The Wallet-Relying Party requests the registration cancellation;
* The Supervisory Body requests the registration suspension/ cancellation.

Then:
* The Registrar suspends/ cancels the registration;
* The Registrar sends notice about the registration suspension/ cancellation;
* The Wallet-Relying Party receives the registration suspension/ cancellation notice;
* The Access Certificate Authority receives the registration suspension/ cancellation notice;
* The Provider of Registration Certificate receives the registration suspension/ cancellation notice.

*3.4 Access / Registration Certificate Revocation*

If:
* The Registrar suspends/ cancels the registration;
* The Wallet-Relying Party requests the certificate revocation;
* The Supervisory Body requests the certificate revocation;
* Data Protection Authority requests the certificate revocation.

Then:
* The Registrar suspends/ revokes the registration;
* The Access Certificate Authority revokes the Access Certificate (without undue delay);
* The Provider of Registration Certificate revokes the Registration Certificate (without undue delay);
* The Access Certificate Authority publishes the Access Certificate revocation status (within 24 hours);
* Provider of Registration Certificate publishes the Access Certificate revocation status (within 24 hours).

### Alternative Flows
- **A1**: [Alternative scenario 1]
  - Step X: [Different action]
  - Continue from step Y
- **A2**: [Alternative scenario 2]
  - [Description of alternative path]

### Exception Flows
- **E1**: [Exception condition 1]
  - Step X: [Error condition occurs]
  - [Error handling steps]
- **E2**: [Exception condition 2]
  - [Description of exception handling]

### Postconditions
- **Success**: [State after successful completion]
- **Failure**: [State after failure]
- **Data Changes**: [What data is modified]

### Business Rules
- [Rule 1: Specific business constraint]
- [Rule 2: Policy requirement]
- [Rule 3: Compliance requirement]

### Non-Functional Requirements
- **Performance**: [Response time requirements]
- **Security**: [Security requirements]
- **Reliability**: [Availability requirements]
- **Scalability**: [Load handling requirements]

### Dependencies
- **Prerequisites**: [Required use cases or systems]
- **Triggers**: [What initiates this use case]
- **Outputs**: [What this use case produces for others]

### Assumptions
- [Assumption 1: What we assume to be true]
- [Assumption 2: Environmental assumptions]

### Notes
- [Additional context or considerations]
- [Implementation notes]
- [Testing considerations]

## Phase 1. Administrative Onboarding

### 1.1 Registration Application
* The Wallet-Relying Party submits to the National Register the registration application, providing at least the information set out in Annex I;
* The Registrar receives the registration application.

*Requirements:*

- National Registers:
    -    Member States shall make the information set out in Annex I on registered wallet-relying parties publicly available online, **both in human-readable form and in a form suitable for automated processing.** 
    -    The information referred to in **paragraph 2 shall be available through a single common application programming interface (‘API’) and through a national website. **It shall be electronically signed or sealed by or on behalf of the registrar, in accordance with the common requirements for a single API set out in Section 1 of Annex II.
    -    Member States shall ensure that the **API referred to in paragraph 5** complies with the **common requirements set out in Section 2 of Annex II.** [IA | Art. 3. National registers]
- Wallet-relying parties shall at least provide the **information set out in Annex I to national registers.** [IA / Art. 5 / Information to be provided to the national registers]
- The list of information to be provided:
    - official name of the wallet-relying party
    - one or more official identifiers of the wallet-relying party (EORI, LEI, VAT number...)
    - physical address and member state if not present in official identifier
    - URL belonging to the wallet-relying party where applicable
    - detailed contact information
    - description of the type of services provided
    - a list of the attributes that the relying party intends to request
    - a description of intended use of the data
    - indication whether the wallet-relying party is a public sector body
    - applicable entitlement(s) of the wallet-relying party chosed between:
    - Service_Provider
    - QEAA_Provider
    - Non_Q_EAA_Provider
    - PUB_EAA_Provider
    - PID_Provider
    - QCert_for_ESeal_Provider
    - QCert_for_ESig_Provider
    - rQSigCDs_Provider
    - rQSealCDs_Provider
    - ESig_ESeal_Creation_Provider
    - indication that the wallet-relying party relies upon an intermediary [IA / Annex I / Wallet Relying Party Information]
- Requirements for electronic signatures or seals applied to the information made available on registered wallet-relying: 
    - shall be JSON advanced electronic signatures at conformance level B-B, B-T or B-LT, and comply with ETSI TS 119 182-1 (JAdES baseline signatures [IA / Annex II / API common requirements]
- Requirements on the API for the register:
    - be a REST API, supporting JSON as format with JAdES or ASIC signature format
    - allow any requestor, without prior authentication, to make (search/read) requests to the register, for information about a wallet-relying party
    - be published and documented using OpenAPI version 3 [IA / Annex II / API common requirements]

### 1.2 Registration Review

The Registrar verifies the registration application;
If needed, the Registrar requests additional information (the application status becomes "pending");
If required, the Wallet-Relying Party sends additional information.

*Requirements:*
- Where appropriate, the requirements set out in the national registration policy shall **not impede an automated registration process.** [IA| Art. 4. Registration policies]
- Registrars shall establish **easy to use electronic, and where possible, automated registration processes** for wallet-relying parties.
Where possible, registrars shall verify in an automated manner:
    * (a) the accuracy, validity, authenticity and integrity of the information required under Article 5;
    * (b) where applicable, the power of attorney of representatives of the wallet-relying parties drawn up and submitted in accordance with the laws and procedures of the Member State where the national register is established;
    * (c ) the type of entitlement or entitlements of the wallet-relying parties as set out in Annex I;
    * (d) the absence of an existing registration in another national register.
- Registrars shall verify the information set out in paragraph 3 against the supporting documentation provided by the wallet-relying parties or against appropriate authentic sources or other official electronic records in the Member State where the national register is established and to which the registrars have access in accordance with the applicable national laws and procedures.
The verification of entitlements of wallet-relying parties referred to in paragraph 3, point ( c ) shall be carried out in accordance with Annex III. [IA |  Art. 6 / Registration processes]
- Source of documentary evidence for the verification of entitlements of wallet-relying parties:
    - verification of qualified trust service providers - shall be based on the national trusted lists in accordance with Article 22 of Regulation (EU) No 910/2014
    - verification of non-qualified trust service providers - shall be based on the national trusted lists or on national MS verification procedures (set out in their registration policies)
    - verification of providers of person identification data - shall be based on the list of providers of person identification data published by the Commission in accordance with Article 5a(18) of Regulation (EU) No 910/2014
    - verification of providers of electronic attestations of attributes issued by or on behalf of a public sector body responsible for an authentic source - shall be based on the list published by the Commission in accordance with Article 45f(3) of Regulation (EU) No 910/2014 [IA /  Annex III / Source of documentary evidence for the verification of entitlements of wallet-relying parties referred to in Article 6]

### 1.3 Registration Confirmation

- The Registrar validates or rejects the registration application (the application status becomes "accepted or rejected");
- The Wallet-Relying Party receives positive or negative feedback on registration applicat.

*Requirements:*
- Registrars shall process applications for registration without undue delay and provide a response to the application for registration to the applicant within the timeframe defined in the applicable registration policy, using appropriate means and in accordance with the laws and procedures of the Member State where the national register is established.[IA / Art. 6 / Registration processes]

## Phase 2. Technical Onboarding

### 2.1 Access Certificate Request
* The Wallet-Relying Party requests the Access Certificate;
* The Access Certificate Authority receives the Access Certificate request.

*Requirements:*

* The Access Certificate Authority has:
    * Certificate policy --> shall describe the security requirements that apply to, and the rules that indicate the applicability of, a wallet-relying party access certificate so that wallet-relying parties can be issued with and use those certificates in their interactions with wallet solutions.
    * Access certificate practice statement --> shall describe the practices that a provider of wallet-relying party access certificates employs in issuing, managing, revoking, and re-keying wallet-relying party access certificates.
* The certificate policy and certificate practice statement applicable to the provision of wallet-relying party access certificates shall be syntactically and semantically harmonised across the Union and shall, as applicable, comply with at least the normalised certificate policy (‘NCP’) requirements as specified in standard ETSI EN 319411-1 version 1.4.1 (2023-10). [IA /  Annex IV / Requirements for wallet-relying party access certificates referred to in Article 7]

### 2.2 Access Certificate Request Review
* The Access Certificate Authority verifies the identity and any other attributes of the wallet-relying party;
* The Access Certificate Authority checks the valid registration status and information coherency within a national register in which that Wallet-Relying Party is established.

*Requirements:*

* Member States shall ensure that providers of wallet-relying party access certificates issue wallet-relying party access certificates exclusively to registered wallet-relying parties. [IA /  Art. 7 / Wallet-relying party access certificates]
* The certificate policy and certificate practice statement applicable to the provision of wallet-relying party access certificates [...] shall include:
    * (a) a clear description of the public key infrastructure hierarchy and certification paths from the end-entity wallet-relying party access certificates up to the top of the hierarchy used for issuing them, indicating the expected trust anchor(s) in such hierarchy and paths which should rely on the trust framework established in accordance with Article 5a(18) of Regulation (EU) No 910/2014;
    * (b) a comprehensive description of the procedures for the issuance of wallet-relying party access certificates, including for the verification of the identity and any other attributes of the wallet-relying party to which a wallet-relying party certificate is to be issued;
    * (c ) the obligation for the providers of wallet-relying party access certificates, when issuing a wallet-relying party access certificate, to verify that:
        * the wallet-relying party is included, with a valid registration status, in a national register of wallet-relying parties of the Member State in which that wallet-relying party is established;
        * any information in the wallet-relying party access certificate is accurate and consistent with the registration information available from that register.
[IA /  Annex IV / Requirements for wallet-relying party access certificates referred to in Article 7]

### 2.3 Access Certificate Issuance
* The Access Certificate Authority issues the Access Certificate and logs the Access Certificate issued;
* The Registrar keeps records of the issuance of Wallet-Relying Party Access Certificate for 10 years and publishes its history within a common REST API (JSON format).

*Requirements:*

* The certificate policy and certificate practice statement applicable to the provision of wallet-relying party access certificates [...] shall include:
    * (j) The provider of wallet-relying party access certificates logs all wallet-relying party access certificates they have issued, in compliance with internet engineering task force (‘IETF’) request for comments (‘RFC’) 9162 Certificate Transparency version 2.0;
    * (k) the obligation for the wallet-relying party access certificates to include:
        * the location where the certificate supporting the advanced electronic signature or advanced electronic seal on that certificate is available, for the entire certification path to be built up to the expected trust anchor in the public key infrastructure hierarchy used by the provider;
        * a machine processable reference to the applicable certificate policy and certificate practice statement;
        * the information referred to in Annex I, points 1, 2, 3, 5, 6 and 7, (a), (b) and (c ).
        [IA /  Annex IV / Requirements for wallet-relying party access certificates referred to in Article 7]
* The registrant receives one or more ‘Wallet-Relying Party Access Certificates’ 
* ANNEX IV (summary) --> Requirements for wallet-relying party access certificates:
    * X.509 certificate with certificate policy and certificate practice statement
    * shall comply with IETF RFC 3647
    * plus additional requirements set out in the Annex IV
* Reg_33 --> All Relying Party Instance access certificates of a Relying Party SHALL include the user-friendly (common) name of Relying Party service and unique identifier identical to the ones defined in requirements RPRC_03a and RPRC_03b, respectively.
[Topic X / Relying Party Registration / 2.2 Draft CIR on Relying Party registration]
* Registrars shall keep records of the information provided by wallet-relying parties and registered in accordance with Annex I for the registration of a wallet-relying party and the issuance of the wallet-relying party access certificates and the wallet-relying party registration certificates, and of any subsequent changes to this information, for 10 years. [IA /  Art. 10 / Record keeping]
* (1) The single common API shall:
    * (b) allow any requestor, without prior authentication, to search and request complete lists to the register, for information about registered wallet-relying parties, allowing for partial matches based on defined parameters including, where applicable, the official or business registration number of the wallet-relying party, the name of the wallet-relying party or the information referred to in Article 8, paragraph 2, point (g) and Annex I points 12, 13, 14 and 15;
    * (c ) ensure that replies to requests referred to in point (b) that match at least one wallet-relying party shall include one or more statements on information about registered wallet-relying parties and information according to Annex I, current and historic wallet-relying party access certificates and wallet-relying party registration certificates but exclude the contact information in Annex I point 4; 
    [IA /  Annex II /API common requirements]
* (1) The single common API shall:
    * (a) be a REST API, supporting JSON as a format and signed in accordance with the relevant requirements specified in Section 1;
    * [...]
    * (d) be published as an OpenAPI version 3, together with the appropriate documentation and technical specifications ensuring interoperability across the Union;
    * (e) provide security functions, including security by default and by design, to ensure the availability and integrity of the API and the availability of information through it.
* (2) The statements referred to in point (c ) shall be expressed under the form of electronically signed or sealed JSON files, with a format and structure in accordance with the requirements on electronic signatures or seals set out Section 1. [IA /  Annex II /API common requirements]

### 2.4 Registration Certificate Request
* The Wallet-Relying Party requests the Registration Certificate;
* The Provider of Registration Certificate receives the Registration Certificate request.

*Requirements:*

* The Provider of Registration Certificate has:
    * Certificate policy --> shall describe the security requirements that apply to, and the rules that indicate the applicability of, a wallet-relying party registration certificate so that wallet-relying parties can be issued with and use those certificates in their interactions with wallet solutions. Shall be in human-readable format.
    * Registration certificate practice statement --> shall describe the practices that a provider of wallet-relying party registration certificates employs in issuing, managing, revoking, and re-keying wallet-relying party registration certificates. Shall be in human-readable format.
    [IA / Annex V / Requirements for wallet-relying party registration certificates referred to in Article 8]
* The certificate policy and certificate practice statement applicable to the provision of wallet-relying party registration certificates shall be syntactically and semantically harmonised across the Union and shall comply with at least the applicable NCP requirements as specified in standard ETSI EN 319411-1 version 1.4.1 (2023-10) [IA / Annex V / Requirements for wallet-relying party registration certificates referred to in Article 8]

### 2.5 Registration Certificate Request Review
* The Provider of Registration Certificate verifies the identity and any other attributes of the Wallet-Relying Party;
* The Provider of Registration Certificate checks the valid registration status and information coherency within a national register in which that Wallet-Relying Party is established.

*Requirements:*
* The certificate policy and certificate practice statement applicable to the provision of wallet-relying party registration certificates [...] shall include:
    * (a) a clear description of the public key infrastructure hierarchy and certification paths from the end-entity wallet-relying party access certificates up to the top of the hierarchy used for issuing them, indicating the expected trust anchor(s) in such hierarchy and paths which should rely on the trust framework established in accordance with Article 5a(18) of Regulation (EU) No 910/2014;
    * (b) a comprehensive description of the procedures for the issuance of wallet-relying party registration certificates, including for the verification of the identity and any other attributes of the wallet-relying party to which a wallet-relying party certificate is to be issued; 
    * (c ) the obligation for the provider of wallet-relying party registration certificates, when issuing a wallet-relying party registration certificate, to verify that:
        * the wallet-relying party is included, with a valid registration status, in a national register for wallet-relying parties of the Member State in which that wallet-relying party is established;
        * the information in the wallet-relying party registration certificate is accurate and consistent with the registration information available from that register;
        * the wallet-relying party access certificate is valid;
[IA /  Annex V / Requirements for wallet-relying party registration certificates referred to in Article 8]
* Member State shall;
    * (a) require providers of wallet-relying party registration certificates to issue wallet-relying party registration certificates exclusively to registered wallet-relying parties;
    * (b) ensure that each intended use is expressed in the wallet-relying party registration certificates;
[IA / Art. 8 / Wallet-relying party registration certificates]

### 2.6 Registration Certificate Issuance
* The Provider of Registration Certificate issues the Registration Certificate and logs the Registration Certificate issued;
* The Registrar keeps records of the issuance of Wallet-Relying Party Registration Certificate for 10 years and publishes its history within a common REST API (JSON format).

*Requirements:*
* The certificate policy and certificate practice statement applicable to the provision of wallet-relying party registration certificates [...] shall include:
    * (i) The provider of wallet-relying party registration certificates logs all wallet-relying party registration certificates they have issued;
(j) the obligation for the wallet-relying party registration certificates to include:
    * the location where the validation data of the advanced electronic signature or advanced electronic seal for the certificate used to sign or seal the registration certificate is available, for the entire trust chain to be built up to the expected trust anchor;
    * a machine-readable reference to the applicable certificate policy and certificate practice statement;
    * the information referred to in Annex I, points 1, 2, 3, 5, 6 and 8, 9, 10, 11, 12, 13, 14 and 15;
    * the URL to the privacy policy referred to in Article 8(2)g;
    * a general access policy as referred to in Article 8(3);
* The data exchange format for the relying party registration certificate shall be signed JSON Web Tokens (IETF RFC 7519) and CBOR Web Tokens (IETF RFC 8392).
    [IA /  Annex V / Requirements for wallet-relying party registration certificates referred to in Article 8]
* The registrant receives one or more 'Wallet-Relying Party Registration Certificates' 
* ANNEX V (summary) --> Requirements for wallet-relying party registration certificates:
    * certificate policy and certificate practice statement shall comply with IETF RFC 3647 and IETF RFC 5755
    * includes the information referred to in Annex I, points 1, 2 and 8;
    * expresses attributes in way compliant with IETF RFC 5755;
    * plus additional requirements set out in the Annex V.
[Topic X / Relying Party Registration / 2.2 Draft CIR on Relying Party registration]
* Registrars shall keep records of the information provided by wallet-relying parties and registered in accordance with Annex I for the registration of a wallet-relying party and the issuance of the wallet-relying party access certificates and the wallet-relying party registration certificates, and of any subsequent changes to this information, for 10 years. [IA /  Art. 10 / Record keeping]
* (1) The single common API shall:
    * (b) allow any requestor, without prior authentication, to search and request complete lists to the register, for information about registered wallet-relying parties, allowing for partial matches based on defined parameters including, where applicable, the official or business registration number of the wallet-relying party, the name of the wallet-relying party or the information referred to in Article 8, paragraph 2, point (g) and Annex I points 12, 13, 14 and 15;
    * (c ) ensure that replies to requests referred to in point (b) that match at least one wallet-relying party shall include one or more statements on information about registered wallet-relying parties and information according to Annex I, current and historic wallet-relying party access certificates and wallet-relying party registration certificates but exclude the contact information in Annex I point 4;
    [IA /  Annex II /API common requirements]
* (1) The single common API shall:
    * (a) be a REST API, supporting JSON as a format and signed in accordance with the relevant requirements specified in Section 1;
    * [...]
    * (d) be published as an OpenAPI version 3, together with the appropriate documentation and technical specifications ensuring interoperability across the Union;
    * (e) provide security functions, including security by default and by design, to ensure the availability and integrity of the API and the availability of information through it.
* (2) The statements referred to in point (c ) shall be expressed under the form of electronically signed or sealed JSON files, with a format and structure in accordance with the requirements on electronic signatures or seals set out Section 1. [IA /  Annex II /API common requirements]

## Phase 3. Post-Onboarding

### 3.1 Registration Update

- When needed, the Wallet-Relying Party updates information
- The Registrar receives the updated information

*Requirements:*

- 1.   [...]
2.   Wallet-relying parties shall ensure that the information provided is accurate at the time of registration.
3.   Wallet-relying parties shall update any information previously registered in the national register of wallet-relying parties without undue delay. [IA / Art. 5 / Information to be provided to the national registers]
- The wallet-relying party registration certificate policy and certificate practice statement applicable to the provisioning of wallet-relying party registration certificates [...] shall include:
  - (d) the obligation for the provider of wallet-relying party registration certificates implements measures and processes on:
    - continuously monitoring in an automated manner any changes in the national register for wallet-relying parties in which wallet-relying parties to whom they have issued wallet-relying party registration certificates are registered;
    - reissue the wallet-relying party registration certificate;[IA /  Annex V / Requirements for wallet-relying party registration certificates referred to in Article 8]

### 3.2 Registration Monitoring

- The Registrar monitors continuosly
- The Access Certificate Authority monitors continuosly and automatically
- The Provider of Registration Certificate monitors continuosly and automatically
- Supervisory Body monitors continuosly
- Data Protection Authority monitors continuosly

*Requirements:*

- 1.   [...]
2.   Registrars may suspend or cancel a registration of a wallet-relying party where the registrars have reasons to believe one of the following:
    -    (a) the registration contains information, which is inaccurate, out of date or misleading;
    -    (b) the wallet-relying party is not compliant with the registration policy;
    -    (c ) the wallet-relying party is requesting more attributes than they have registered in accordance with Article 5 and Article 6;
    -    (d) the wallet-relying party is otherwise acting in breach of Union or national law in a manner related to their role as wallet-relying party. [IA / Art. 9 / Suspension and cancellation of registration]

- The certificate policy and certificate practice statement applicable to the provision of wallet-relying party access certificates [...] shall include:
    - [...]
    - (e) the obligation for the providers of wallet-relying party access certificates to implement measures and processes on:
      - continuously monitoring any changes in the national register for wallet-relying parties in which wallet-relying parties to whom they have issued wallet-relying party access certificates are registered;
      - [...]
    - [...]  [IA /  Annex IV / Requirements for wallet-relying party access certificates referred to in Article 7]

- The certificate policy and certificate practice statement applicable to the provision of wallet-relying party registration certificates [...] shall include:
    - [...]
    - (d) the obligation for the provider of wallet-relying party registration certificates implements measures and processes on:
      - continuously monitoring in an automated manner any changes in the national register for wallet-relying parties in which wallet-relying parties to whom they have issued wallet-relying party registration certificates are registered;
      - [...]
    - [...] [IA /  Annex V / Requirements for wallet-relying party registration certificates referred to in Article 8]

### 3.3 Registration Suspension / Revocation

If:

- If needed, the National Registrar conducts a proportionality assessment
- The Wallet-Relying Party requests the registration revocation
- The Supervisory Body requests the registration suspension/ revocation

Then:

- The Registrar suspends/ revokes the registration
- The Registrar sends notice about the suspension/ revocation
- The Wallet-Relying Party receives the registration suspension/ revocation notice
- The Access Certificate Authority receives the registration suspension/ revocation notice
- The Provider of Registration Certificate receives the registration suspension/ revocation notice

*Requirements:*
- 3.   [...]
4.   When considering the suspension or cancellation in accordance with paragraph 2, the registrar shall conduct a proportionality assessment, taking into account the impact on the fundamental rights, security and confidentiality of the users in the ecosystem, as well as the severity of the disruption envisaged to be caused by the suspension or cancellation and the associated costs, both for the wallet-relying party and the user. Based on the result of this assessment, the registrar may suspend or cancel the registration with or without prior notice to the affected wallet-relying party.
[...]  [IA / Art. 9 / Suspension and cancellation of registration]

- 1.   Registrars shall suspend or cancel a registration of a wallet-relying party where such a suspension or cancellation is requested by a supervisory body pursuant to Article 46a(4), point (f) of Regulation (EU) No 910/2014.
[...]
3.   Registrars shall suspend or cancel a registration of a wallet-relying party where the request for cancellation or suspension is made by the same wallet-relying party.
[...]  [IA / Art. 9 / Suspension and cancellation of registration]

- When a wallet-relying party no longer intends to rely upon wallet units for the provision of public or private services under a specific registration, it shall notify the relevant registrar without undue delay and request the cancellation of that registration. [IA / Art. 9 / Registration process]
- [...]
5.   Where the registration of a wallet-relying party is suspended or cancelled, the registrar shall inform the provider of the relevant wallet-relying party access certificates, the provider of the relevant wallet-relying party registration certificates, and the affected wallet-relying party of this action without undue delay and not later than 24 hours after the suspension or cancellation. This notification shall include information on the reasons for the suspension or cancellation and on the available means of redress or appeal.
[...]  [IA / Art. 9 / Suspension and cancellation of registration]
- [...]
6.   The provider of wallet-relying party access certificates and the provider of wallet-relying registration certificates, shall, where applicable, revoke without undue delay the wallet-relying party access certificates, and the wallet-relying party registration certificates, respectively, of the wallet-relying party for which registration has been suspended or cancelled.
[...]  [IA / Art. 9 / Suspension and cancellation of registration]

### 3.4 Access / Registration Certificate Revocation

If:

- The Registrar suspends/ revokes the registration
- The Wallet-Relying Party requests the certificate revocation
- The Supervisory Body requests the certificate revocation
- Data Protection Authority requests the certificate revocation

Then:

- The Registrar suspends/ revokes the registration
- The Access Certificate Authority revokes the Access Certificate (without undue delay)
- The Provider of Registration Certificate revokes the Registration Certificate (without undue delay)
- The Access Certificate Authority publishes the Access Certificate revocation status (within 24 hours)
- Provider of Registration Certificate publishes the Access Certificate revocation status (within 24 hours)

*Requirements:*

- The certificate policy and certificate practice statement applicable to the provision of wallet-relying party access certificates [...] shall include:
    - (d) a comprehensive description of the procedures for revocation of wallet-relying party access certificates;
    - (e) the obligation for the providers of wallet-relying party access certificates to implement measures and processes on:
        - [...]
        -  revoking, when changes require, any wallet-relying party certificate that the -provider issued to the corresponding wallet-relying party, in particular when the content of the certificate is no longer accurate and consistent with the information registered, or when the registration of the wallet-relying party is suspended or cancelled.
    -    (f) [...]
    -    (g) the obligation for the providers of wallet-relying party access certificates to allow relevant stakeholders, including wallet-relying parties as regards their own certificates, competent supervisory bodies and data protection authorities, to request the revocation of wallet-relying party access certificates;
    -    [...]
The revocation set out in point 3(g) shall become effective immediately upon its publication. [IA /  Annex IV / Requirements for wallet-relying party access certificates referred to in Article 7]
- The certificate policy and certificate practice statement applicable to the provision of wallet-relying party access certificates [...] shall include:
    - [...]
    - (h) the obligation for the providers of wallet-relying party access certificates to register all such revocations in its certificate database and to publish the revocation status of the certificate in a timely manner, and in any event within 24 hours after receipt of the revocation request;
    - (i) the obligation for the providers of wallet-relying party access certificates to provide information on the validity or revocation status of wallet-relying party certificates issued by that provider;
    - [...]
The information set out in point 3(h) shall be made available at least on a per certificate basis at any time and at least beyond the validity period of the certificate in an automated manner that is reliable, free of charge and effectively in accordance with the certificate policy. [IA /  Annex IV / Requirements for wallet-relying party access certificates referred to in Article 7]
- The wallet-relying party registration certificate policy and certificate practice statement applicable to the provisioning of wallet-relying party registration certificates [...] shall include:
    - (c) the obligation for the provider of wallet-relying party registration certificates, when issuing a wallet-relying party registration certificate, to verify that:
      - [...]
      - the description of the procedures for revocation of wallet-relying party registration certificates is comprehensive.
    - (d) the obligation for the provider of wallet-relying party registration certificates implements measures and processes on:
      - [...]
      - revoking any wallet-relying party registration certificate that they issued to the corresponding wallet-relying party, when such changes so require, in particular when the content of the certificate is no longer accurate and consistent with the information registered, or when the registration of the wallet-relying party is modified, suspended or cancelled.
    - (e) [...]
    - (f) the obligation for the provider of wallet-relying party registration certificates to allow relevant stakeholders, including wallet-relying parties as regards their own certificates, competent supervisory bodies and data protection authorities, to request the revocation of wallet-relying party registration certificates;
The revocation referred to in point 3(g/f?) shall become effective immediately upon its publication. [IA /  Annex V / Requirements for wallet-relying party registration certificates referred to in Article 8]
- The wallet-relying party registration certificate policy and certificate practice statement applicable to the provisioning of wallet-relying party registration certificates [...] shall include:
  - [...]
  - (g) the obligation for the provider of wallet-relying party registration certificates to register all such revocations in its certificate database and to publish the revocation status of the certificate in a timely manner, and in any event within 24 hours after the receipt of the request for revocation;
  - (h) the obligation for the providers of wallet-relying party registration certificates to provide information on the validity or revocation status of wallet-relying party registration certificates issued by that provider;
  - [...]
The information referred to in point 3(h/g?) shall be made available at least on a per certificate basis at any time and at least beyond the validity period of the certificate in an automated manner that is reliable, free of charge and effectively in accordance with the certificate policy. [IA /  Annex V / Requirements for wallet-relying party registration certificates referred to in Article 8]
