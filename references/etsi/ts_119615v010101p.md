# ETSI TS 119 615 V1.3.1 (2026-01)

*Converted from: ts_119615v010101p.pdf (source PDF may be V1.3.1).*

**Electronic Signatures and Trust Infrastructures (ESI); Trusted lists; Procedures for using and interpreting European Union Member States national trusted lists**

---

ETSI TS 119 615 V1.3.1 (2026-01)
TECHNICAL SPECIFICATION
Electronic Signatures and Trust Infrastructures (ESI);
Trusted lists;
Procedures for using and interpreting European Union
Member States national trusted lists
Reference
RTS/ESI-0019615v131
Keywords
e-commerce, electronic signature, EU qualified,
security, trust services
Tel.: +33 4 92 94 42 00 Fax: +33 4 93 65 47 16
Siret N° 348 623 562 00017 - APE 7112B
Association à but non lucratif enregistrée à la
Sous-Préfecture de Grasse (06) N° w061004871
Important notice
The present document can be downloaded from the
ETSI Search & Browse Standards application.
The present document may be made available in electronic versions and/or in print. The content of any electronic and/or
print versions of the present document shall not be modified without the prior written authorization of ETSI. In case of any
existing or perceived difference in contents between such versions and/or in print, the prevailing version of an ETSI
deliverable is the one made publicly available in PDF format on ETSI deliver repository.
Users should be aware that the present document may be revised or have its status changed,
this information is available in the Milestones listing.
If you find errors in the present document, please send your comments to
the relevant service listed under Committee Support Staff.
If you find a security vulnerability in the present document, please report it through our
Coordinated Vulnerability Disclosure (CVD) program.
Notice of disclaimer & limitation of liability
The information provided in the present deliverable is directed solely to professionals who have the appropriate degree of
experience to understand and interpret its content in accordance with generally accepted engineering or
other professional standard and applicable regulations.
No recommendation as to products and services or vendors is made or should be implied.
No representation or warranty is made that this deliverable is technically accurate or sufficient or conforms to any law
and/or governmental rule and/or regulation and further, no representation or warranty is made of merchantability or fitness
for any particular purpose or against infringement of intellectual property rights.
In no event shall ETSI be held liable for loss of profits or any other incidental or consequential damages.
Any software contained in this deliverable is provided "AS IS" with no warranties, express or implied, including but not
limited to, the warranties of merchantability, fitness for a particular purpose and non-infringement of intellectual property
rights and ETSI shall not be held liable in any event for any damages whatsoever (including, without limitation, damages
for loss of profits, business interruption, loss of information, or any other pecuniary loss) arising out of or related to the use
of or inability to use the software.
Copyright Notification
No part may be reproduced or utilized in any form or by any means, electronic or mechanical, including photocopying and
microfilm except as authorized by written permission of ETSI.
The content of the PDF version shall not be modified without the written authorization of ETSI.
The copyright and the foregoing restriction extend to reproduction in all media.
© ETSI 2026.
All rights reserved.
Contents
Intellectual Property Rights ................................................................................................................................5
Foreword.............................................................................................................................................................5
Modal verbs terminology....................................................................................................................................5
Introduction ........................................................................................................................................................5

## 1 Scope


## 2 References


### 2.1 Normative references


### 2.2 Informative references


## 3 Definition of terms, symbols, abbreviations and notations


### 3.1 Terms


### 3.2 Symbols


### 3.3 Abbreviations


### 3.4 Notations


## 4 Procedures for using and interpreting European Union Member States national trusted lists


### 4.0 General provisions


### 4.1 Authenticating the EC compiled list of trusted lists


#### 4.1.1 Description


#### 4.1.2 Inputs


#### 4.1.3 Outputs


#### 4.1.4 Processing


### 4.2 Authenticating an EUMS trusted list


#### 4.2.1 Description


#### 4.2.2 Inputs


#### 4.2.3 Outputs


#### 4.2.4 Processing


### 4.3 Obtaining listed services matching a certificate


#### 4.3.1 Description


#### 4.3.2 Inputs


#### 4.3.3 Outputs


#### 4.3.4 Processing


### 4.4 EU qualified certificate determination


#### 4.4.1 Description


#### 4.4.2 Inputs


#### 4.4.3 Outputs


#### 4.4.4 Processing


### 4.5 QSCD determination


#### 4.5.1 Description


#### 4.5.2 Inputs


#### 4.5.3 Outputs


#### 4.5.4 Processing


### 4.6 EU trust service token issuer qualification determination


#### 4.6.1 Description


#### 4.6.2 Inputs


#### 4.6.3 Outputs


#### 4.6.4 Processing


### 4.7 EU qualified time stamp determination


#### 4.7.1 Description


#### 4.7.2 Inputs


#### 4.7.3 Outputs


#### 4.7.4 Processing


### 4.8 EU qualified validation service determination


#### 4.8.1 Description


#### 4.8.2 Inputs


#### 4.8.3 Outputs


#### 4.8.4 Processing


### 4.9 EU qualified preservation service determination


#### 4.9.1 Description


#### 4.9.2 Inputs


#### 4.9.3 Outputs


#### 4.9.4 Processing


### 4.10 EU qualified electronic registered delivery service determination


#### 4.10.1 Description


#### 4.10.2 Inputs and parameters


#### 4.10.3 Outputs


#### 4.10.4 Processing


### 4.11 EU qualified archiving service determination


#### 4.11.1 Description


#### 4.11.2 Inputs


#### 4.11.3 Outputs


#### 4.11.4 Processing


### 4.12 EU qualified electronic attestation of attribute service determination


#### 4.12.1 Description


#### 4.12.2 Inputs


#### 4.12.3 Outputs


#### 4.12.4 Processing


### 4.13 EU qualified ledger service determination


#### 4.13.1 Description


#### 4.13.2 Inputs


#### 4.13.3 Outputs


#### 4.13.4 Processing

Annex A (informative):                          Bibliography ...................................................................................................52
Annex B (normative):                            Output sub-statuses changes .........................................................................53
Annex C (informative):                          Change history ...............................................................................................54
History ..............................................................................................................................................................55
Intellectual Property Rights
Essential patents
IPRs essential or potentially essential to normative deliverables may have been declared to ETSI. The declarations
pertaining to these essential IPRs, if any, are publicly available for ETSI members and non-members, and can be
found in ETSI SR 000 314: "Intellectual Property Rights (IPRs); Essential, or potentially Essential, IPRs notified to
ETSI in respect of ETSI standards", which is available from the ETSI Secretariat. Latest updates are available on the
ETSI IPR online database.
Pursuant to the ETSI Directives including the ETSI IPR Policy, no investigation regarding the essentiality of IPRs,
including IPR searches, has been carried out by ETSI. No guarantee can be given as to the existence of other IPRs not
referenced in ETSI SR 000 314 (or the updates on the ETSI Web server) which are, or may be, or may become,
essential to the present document.
Trademarks
The present document may include trademarks and/or tradenames which are asserted and/or registered by their owners.
ETSI claims no ownership of these except for any which are indicated as being the property of ETSI, and conveys no
right to use or reproduce any trademark and/or tradename. Mention of those trademarks in the present document does
not constitute an endorsement by ETSI of products, services or organizations associated with those trademarks.
DECT™, PLUGTESTS™, UMTS™ and the ETSI logo are trademarks of ETSI registered for the benefit of its
Members. 3GPP™, LTE™ and 5G™ logo are trademarks of ETSI registered for the benefit of its Members and of the
3GPP Organizational Partners. oneM2M™ logo is a trademark of ETSI registered for the benefit of its Members and of
the oneM2M Partners. GSM® and the GSM logo are trademarks registered and owned by the GSM Association.
Foreword
This Technical Specification (TS) has been produced by ETSI Technical Committee Electronic Signatures and Trust
Infrastructures (ESI).
Modal verbs terminology
In the present document "shall", "shall not", "should", "should not", "may", "need not", "will", "will not", "can" and
"cannot" are to be interpreted as described in clause 3.2 of the ETSI Drafting Rules (Verbal forms for the expression of
provisions).
"must" and "must not" are NOT allowed in ETSI deliverables except when used in direct citation.
Introduction
Trusted lists, as specified by ETSI TS 119 612 [1], enable in practice any interested party to determine whether a trust
service is or was operating in compliance with relevant requirements, currently or at a given time in the past (e.g. at the
time the service was provided, or at the time at which a transaction reliant on that service took place).
ETSI TS 119 612 [1] provides specifications supporting the establishment and management of trusted lists in two
contexts, namely the European Union (EU) legislative context as set by Regulation (EU) No 910/2014 [i.1] and the
context of countries outside the European Union and the EEA countries, or of international organizations willing to
issue trusted lists in accordance with ETSI TS 119 612 [1].
The actual specifications for EU Member States (EUMS) national trusted lists are provided in Commission
Implementing Decision (EU) 2015/1505 [i.2] laying down technical specifications and formats relating to trusted lists
pursuant to Article 22(5) of Regulation (EU) No 910/2014 [i.1]. Those specifications and formats build upon ETSI
TS 119 612 [1].
EUMS trusted lists have a legal constitutive value. It is the single formal source to verify that a claimed qualified trust
service is indeed granted a qualified status by the competent EUMS body.
The rules for using and interpreting EUMS national trusted lists are provided in CID (EU) 2015/1505 [i.2]. The present
document specifies procedures allowing for implementing those rules when validating EU qualified trust service
outputs against such EUMS trusted lists (e.g. validating qualified certificates, EU qualified time stamps, evidences
created by qualified electronic registered delivery services, EU electronic signatures or seals on EU qualified validation
reports on EU qualified electronic signatures or seals).

## 1 Scope

The present document specifies procedures for using and interpreting EUMS national trusted lists when validating EU
qualified trust service outputs against them (e.g. validating EU qualified certificates, EU qualified time stamps,
evidences created by qualified electronic registered delivery services, EU electronic signatures or seals on EU qualified
validation reports on EU qualified electronic signatures or seals).

## 2 References


### 2.1 Normative references

References are either specific (identified by date of publication and/or edition number or version number) or
non-specific. For specific references, only the cited version applies. For non-specific references, the latest version of the
referenced document (including any amendments) applies.
Referenced documents which are not found to be publicly available in the expected location might be found in the
ETSI docbox.

> NOTE:     While any hyperlinks included in this clause were valid at the time of publication, ETSI cannot guarantee

their long-term validity.
The following referenced documents are necessary for the application of the present document.
[1]               ETSI TS 119 612 (V2.4.1): "Electronic Signatures and Trust Infrastructures (ESI); Trusted Lists".
[2]               ISO 3166-1:2020: "Codes for the representation of names of countries and their subdivisions -
Part 1: Country codes".
[3]               ETSI EN 319 412-5: "Electronic Signatures and Trust Infrastructures (ESI); Certificate Profiles;
Part 5: QCStatements".
[4]               IETF RFC 5280: "Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation
List (CRL) Profile".
[5]               T7 & Teletrust: "Common PKI Specifications for Interoperable Applications", Specification
Part 5: Certificate Path Validation, Version 2.0, 20 January 2009.

### 2.2 Informative references

References are either specific (identified by date of publication and/or edition number or version number) or
non-specific. For specific references, only the cited version applies. For non-specific references, the latest version of the
referenced document (including any amendments) applies.

> NOTE:     While any hyperlinks included in this clause were valid at the time of publication, ETSI cannot guarantee

their long-term validity.
The following referenced documents may be useful in implementing an ETSI deliverable or add to the reader's
understanding, but are not required for conformance to the present document.
[i.1]             Regulation (EU) No 910/2014 of the European Parliament and of the Council on electronic
identification and trust services for electronic transactions in the internal market and repealing
Directive 1999/93/EC.
[i.2]             Commission Implementing Decision (EU) 2015/1505 of 8 September 2015 laying down technical
specifications and formats relating to trusted lists pursuant to Article 22(5) of Regulation (EU)
No 910/2014 of the European Parliament and of the Council on electronic identification and trust
services for electronic transactions in the internal market.
[i.3]               Official Journal of the European Union OJ C 276, 16.08.2019: "Information related to data on
Member States' trusted lists as notified under Commission Implementing Decision (EU)
2015/1505", pp. 1-7.
[i.4]               ETSI TR 119 001: "Electronic Signatures and Infrastructures (ESI); The framework for
standardization of signatures; Definitions and abbreviations".
[i.5]               Void.
[i.6]               IETF RFC 3161: "Internet X.509 Public Key Infrastructure Time-Stamp Protocol (TSP)".
[i.7]               Directive 1999/93/EC of the European Parliament and of the Council of 13 December 1999 on a
Community framework for electronic signatures.
[i.8]               ETSI EN 319 102-1: "Electronic Signatures and Trust Infrastructures (ESI); Procedures for
Creation and Validation of AdES Digital Signatures; Part 1: Creation and Validation".

## 3 Definition of terms, symbols, abbreviations and

notations

### 3.1 Terms

For the purposes of the present document, the terms given in ETSI TR 119 001 [i.4] and the following apply:
pivot LOTL: specific instance of a LOTL that announces changes in the LOTL signing certificates and/or LOTL
location

> NOTE:        For further explanations on the concept of pivot LOTL refer to annex A.

tuple: group of multiple elements or groups of multiple elements

### 3.2 Symbols

Void.

### 3.3 Abbreviations

For the purposes of the present document, the abbreviations given in ETSI TR 119 001 [i.4] and the following apply:
EUMS                European Union Member State
LOTL                List Of Trusted Lists
LOTLSO              LOTL Scheme Operator
OJEU                Official Journal of the European Union
QTS                 Qualified Trust Service
TL                  Trusted List
TSP                 Trust Service Provider

### 3.4 Notations

The requirements in the present document are identified as follows:
<3 letters identifying the section title or type of requirement>-<the clause number>-<2-digit number
(incremental)>
The management of the requirement identifiers for subsequent editions of the present document is as follows:
•       When a requirement is inserted at the end of a clause, the 2-digits number above is incremented to the next
available digit.
•    When a requirement is inserted between two existing requirements, capital letters appended to the previous
requirement identifier are used to distinguish new requirements.
•    The requirement identifier for deleted requirements is kept and completed with "Void".
•    The requirement identifier for modified requirement is kept void and the modified requirement is identified by
capital letter(s) appended to the initial requirement number.

## 4 Procedures for using and interpreting European

Union Member States national trusted lists

### 4.0 General provisions

The present document presents procedures for using and interpreting European Union Member States national trusted
lists in the form of algorithms, which provide a conformant behaviour when implemented by a conformant application.
GPR-4.0-01: Alternative implementations may be used provided that they shall produce the same output and main
status indication when given the same set of input information.
GPR-4.0-02: The following parameters shall be preconfigured as follows for use in all the procedures specified in the
remaining clauses of the present document:
Name                                                     Description - Value
OJEU-Loc                         URI value referencing the latest publication of the Official Journal of the European
Union (OJEU) related to data on EUMS TL as they are notified under Commission
Implementing Decision (EU) 2015/1505 [i.2].
OJEU-LOTL-Loc                    URI value representing the location where the current instance of the XML file of the
LOTL is available, as specified in the OJEU publication available from OJEU-Loc.
OJEU-LOTL- Certs-Set             The full set of certificates used for ensuring authenticity and integrity of the LOTL as
provided in the OJEU publication available from OJEU-Loc.

> NOTE 1: At the time of publication of the present document:

•    The URI value described in the OJEU-Loc row of the above table was:
https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=uriserv:OJ.C_.2019.276.01.0001.01.ENG [i.3].
•    This URI value is expected to be the first URI value not ending by ".xml" in the sequence of URI values
present in the 'Scheme information URI' field of the LOTL (see clause 5.3.7 of ETSI TS 119 612 [1]).
•    The URI value described in the OJEU-LOTL-Loc row of the above table was:
https://ec.europa.eu/tools/lotl/eu-lotl.xml.

> NOTE 2: Such initial configurations are likely to be performed outside the software application implementing the

procedures specified in the present document and come from configuration files or other appropriate
source. Once configured, and as per the content of OJ C 233 276 [i.3] and the explanation material
available from that publication, those three variables can be updated in a machine processable way as
further explained and specified in clause 4.1.
GPR-4.0-03: In the procedures specified in the present document, whenever the validation of an https connection fails,
implementations should refrain from stopping the processing for that reason but should add an appropriate warning to
the corresponding procedure sub-status information.

### 4.1 Authenticating the EC compiled list of trusted lists


#### 4.1.1 Description

EUMS Trusted Lists (TLs) have a legal constitutive value. It is the single formal source to verify that a claimed EU
qualified trust service provider and the claimed EU qualified trust service it provides are indeed granted an EU qualified
status by the competent EUMS body.
Regulation (EU) No 910/2014 [i.1] mandates EUMS to set up their national TL, at least under an XML machine
processable format, compliant to the specifications established by CID (EU) 2015/1505 [i.2] building upon ETSI
TS 119 612 [1].
EUMS have the obligation to electronically sign or seal the XML version of their national TL by means of a digital
signature compliant with the specifications of CID (EU) 2015/1505 [i.2] relying on clause 5.7.1 of ETSI
TS 119 612 [1]. To verify such a digital signature, relying parties need to be able to access the applicable public key.
In order to allow access to the TLs of all Member States in an easy manner, the European Commission (EC) publishes a
central list, called the List Of Trusted Lists (LOTL), with links to the locations where the TLs are published as notified
by Member States. The public key certificate(s) corresponding to the private key(s) entitled to be used to sign EUMS
TLs and hence to be used by relying parties to validate those TL signatures are notified by the EUMSs to the EC and
published in the LOTL as well. The LOTL is available in a format suitable for automated processing (XML).
The authenticity and integrity of the machine processable version of the LOTL is ensured through a digital signature
supported by a certificate which can be authenticated through a publication in the Official Journal of the European
Union.
At the time of publication of the present document, pursuant to a publication in the OJEU C276 [i.3], the LOTL can be
accessed from the following location: https://ec.europa.eu/tools/lotl/eu-lotl.xml.
OJEU C276 [i.3] additionally identifies and authenticates the LOTL Scheme Operator (LOTLSO) public key
certificate(s) corresponding to the private key(s) entitled to be used to sign the LOTL and hence the public keys to be
used by relying parties to validate the LOTL signature.
Both the location of the LOTL and the LOTLSO certificates can be updated through a new publication in the OJEU or
through the mechanism of pivot LOTL in accordance with OJEU C276 [i.3]. The LOTLSO certificates and the location
of the LOTL XML file are contained in the LOTL itself, as part of the first tuple of the 'Pointers to other TSLs' field of
the LOTL as specified in clause 5.3.13 of ETSI TS 119 612 [1] and whose 'Scheme territory' corresponds to the "EU"
country code. This enables relying parties to detect in a machine processable way a change in the LOTLSO certificates
and/or in its location. Any such future change will be reflected in the publication of a new instance of a pivot LOTL
which will include a new location URL and/or a modified set of digital certificates for relying parties to use when
authenticating the LOTL. The change of the location of the LOTL will always lead to a new publication of the OJEU to
authenticate such a new location. A change of the LOTL location is made effective in a pivot LOTL while the previous
location is maintained and the current instance of the LOTL is kept available at that location until the next publication
in the OJEU and for a further transition period.
Starting at the date of issuance of the pivot LOTL in which new LOTLSO certificates and/or new location is first
published, the new URL and/or a modified set of digital certificates can be used by relying parties to locate and
authenticate the LOTL in replacement of the formerly issued information. It is however always possible for the
European Commission to publish a new publication in the OJEU, for instance as a temporary response to an emergency
situation requiring the immediate replacement of all the digital certificates of the LOTL.
Each instance of the LOTL will include, as the first part of the information regarding the underlying scheme ('Scheme
information URI" element as specified in clause 5.3.7 of ETSI TS 119 612 [1]), in their chronological order showing the
most recent element first, the list of:
•     when applicable, one or more URLs where the last archived previous instance(s) of the pivot LOTL containing
a new location and/or a modified set of digital certificates of the LOTL is(are) published, back until and
followed by;
•     the URL of the latest relevant publication in the OJEU resetting the initial location and the initial set of digital
certificates for relying parties to use when authenticating the LOTL.
In case of a transition between two publications in the OJEU, the above list can be piled on top of the list of pivot
LOTLs, when applicable and the URL of the previous relevant publication in the OJEU resetting the initial location and
the initial set of digital certificates for relying parties to use when authenticating the LOTL.
Each pivot LOTL is digitally signed by means of a private key for which the corresponding digital certificate is part of
the set of LOTLSO certificates included in the previous pivot LOTL or included in the latest OJEU publication when
the pivot LOTL is the first from that OJEU publication.
The current instance of the LOTL includes the exact same set of LOTLSO certificates included in the previous pivot
LOTL and is digitally signed by means of a private key corresponding to one of these LOTLSO certificates.
The procedure specified in clause 4.1 allows to obtain the authenticated XML version of the current instance of the
LOTL.

> NOTE:      Further information about the concept of pivot LOTL and on the procedure related to the change of

location of the LOTL can be found in OJEU C276 [i.3] and in particular in the referenced webpage
https://ec.europa.eu/tools/lotl/pivot-lotl-explanation.html.

#### 4.1.2 Inputs

The parameters OJEU-Loc, OJEU-LOTL-Loc and OJEU-LOTL-Certs-Set shall either initially be configured as
specified in GPR-4.0-02 or updated through the regular processing specified in clause 4.1.4.

#### 4.1.3 Outputs

Name                                                          Description
Authenticated-LOTL               The authenticated XML version of the current instance of the LOTL.
LOTL-Status                      The status indication of the process of authenticating the current instance of the LOTL.
LOTL-Sub-Status                  A list of indications supplementing LOTL-Status indication of the process of
authenticating the current instance of the LOTL.
OUT-4.1.3-01: All above listed output variables shall be initialized to void.

#### 4.1.4 Processing


> NOTE 1: The processing basically checks the chain of trust between the LOTL XML file obtained from

OJEU-LOTL-Loc input and the OJEU-LOTL- Certs-Set input. It checks in particular that:
-       the public key certificate corresponding to the private key having signed the LOTL XML file is
part of the set of certificates included in the LOTL itself as part of the pointer to itself;
-       when no pivot LOTL is present, the public key certificate corresponding to the private key having
signed the LOTL XML file is part of the set of certificates included in the OJEU-LOTL- Certs-
Set.
-       when pivot LOTL is/are present:
       each pivot LOTL is signed by means of a private key for which the corresponding digital
certificate:
-     is part of the set of certificates included in the previous pivot LOTL or included in the
latest OJEU publication when the pivot LOTL is the first from that OJEU publication;
and
-     is part of the set of certificates included in the pivot LOTL itself as part of the pointer to
itself;
-       the current instance of the LOTL includes the exact same set of LOTLSO certificates included in
he previous pivot LOTL and is signed by means of a private key corresponding to one of these
LOTLSO certificates.
The signatures of the LOTL and of each pivot LOTL are valid.
Additional consistency checks are performed:

> NOTE 2: As per OJEU C276 [i.3] and in particular the referenced webpage https://ec.europa.eu/tools/lotl/pivot-lotl-

explanation.html, in case of changing the LOTL location.
a)    The first element value that will change is the 'TSLLocation' value string containing the URI of the machine
processable format of the LOTL in the pointer to the LOTL in the LOTL itself. When this is the case, the
OJEU-LOTL-Loc parameter (see clause 4.0) can be updated with that new location.
b)    Subsequently, when the first encountered element of the LOTL 'Scheme information URI' whose value is not
ending by ".xml" is not the value of the configured OJEU-Loc parameter (see clause 4.0), then this parameter
can be updated with that new value. This reflects the latest publication of the OJEU related to data on EUMS
TL as they are notified under Commission Implementing Decision (EU) 2015/1505 [i.2].
c)    The parameter OJEU-LOTL-Certs-Set (see clause 4.0) can be updated either in an automated way from
the set of certificates available in the pointer to the LOTL from the LOTL instance that first includes the new
value of the latest publication of the OJEU referred in point b) above, or "manually" directly from that
publication.
PRO-4.1.4-01: The processing shall set LOTL to the current instance of the LOTL XML file obtained from
OJEU-LOTL-Loc.
PRO-4.1.4-02: The processing shall set LOTL-Signer-Cert to the ds:X509Certificate value of the
ds:KeyInfo of the ds:Signature of LOTL.
PRO-4.1.4-03: If the processing parses the 'Scheme information URI' element of LOTL as specified in clause 5.3.7 of
ETSI TS 119 612 [1] without finding a URI value matching the OJEU-Loc value, then:
a)    the processing shall set Authenticated-LOTL to void;
b)    the processing shall set LOTL-Status to the value "LOTL_VERIFICATION_FAILED";
c)    the processing shall set LOTL-Sub-Status to the value
"OJEU_LOCATION_INPUT_NOT_MATCHING_OJEU_LOCATION_IN_LOTL"; and
d)    the processing shall stop the process.

> NOTE 3: It is likely that the configuration specified in GPR-4.0-02 is not taking into consideration the latest

publication of the OJEU related to data on EUMS TL as they are notified under Commission
Implementing Decision (EU) 2015/1505 [i.2].
PRO-4.1.4-04: The processing shall set 'n' to the number of successive URIs having an https scheme, an authority, and
a non-empty path ending with the character string ".xml" until the URI value matching the OJEU-Loc value, as those
URIs are listed in the 'Scheme information URI' element of LOTL as specified in clause 5.3.7 of ETSI TS 119 612 [1].
PRO-4.1.4-05: If OJEU-LOTL-Loc is not matching the TSLLocation string available in the tuple from the 'Pointers to
other TSLs' field of LOTL (see clause 5.3.13 of ETSI TS 119 612 [1]) whose 'Scheme territory' qualifier has the value
"EU" and if LOTL does not match the XML file obtained from that TSLLocation string, then:
a)    the processing shall set Authenticated-LOTL to void;
b)    the processing shall set LOTL-Status to the value "LOTL_VERIFICATION_FAILED";
c)    the processing shall set LOTL-Sub-Status to the value "LOTL_FILE_CONFLICT"; and
d)    the processing shall stop the process.
PRO-4.1.4-06: If OJEU-LOTL-Loc is matching the TSLLocation string available in the tuple from the 'Pointers to
other TSLs' field of LOTL (see clause 5.3.13 of ETSI TS 119 612 [1]) whose 'Scheme territory' qualifier has the value
"EU" and if LOTL does not match the XML file obtained from that TSLLocation string, then:
a)    the processing shall set LOTL to the XML file obtained from that TSLLocation string; and
b)    the processing shall go to PRO-4.1.4-02.

> NOTE 4: This case corresponds to the publication of a new LOTL instance from the time of the initialization of

LOTL.
PRO-4.1.4-07: The processing shall validate ds:Signature of LOTL considering LOTL-Signer-Cert as a
directly trusted certificate, i.e. as a trust anchor.

> NOTE 5: This corresponds to the basic signature validation process of ETSI EN 319 102-1 [i.8].

PRO-4.1.4-08: If the signature validation performed in PRO-4.1.4-07 failed or was indeterminate, then:
a)    the processing shall set Authenticated-LOTL to void;
b)    the processing shall set LOTL-Status to the value "LOTL_VERIFICATION_FAILED";
c)    the processing shall set LOTL-Sub-Status to the values provided by the validation procedure together with
the additional value "LOTL_SIGNATURE_VERIFICATION_FAILED"; and
d)    the processing shall stop the process.
PRO-4.1.4-09: The processing shall set the following variables to the following values:
a)    LOTLSO-Cert to LOTL-Signer-Cert; and
b)    LOTLSO-Certs-Set to the full set of certificates available in the tuple from the 'Pointers to other TSLs' field
(see clause 5.3.13 of ETSI TS 119 612 [1]) of LOTL, whose 'Scheme territory' qualifier has the value "EU".
PRO-4.1.4-10: If n is equal to 0, then:
a)    If LOTLSO-Cert is not part of LOTLSO-Certs-Set then:
1)   the processing shall set Authenticated-LOTL to void;
2)   the processing shall set LOTL-Status to the value "LOTL_VERIFICATION_FAILED";
3)   the processing shall set LOTL-Sub-Status to the value
"LOTL_SIGNER_CERT_NOT_AUTHENTICATED_BY_LOTL"; and
4)   the processing shall stop the process.
b)    The processing shall go to PRO-4.1.4-12.
PRO-4.1.4-11: For all i in [1..n]:
a)    The processing shall set Pivot to the instance of the XML file obtained from the ith successive URI having
an https scheme, an authority, and a non-empty path ending with the character string ".xml" until the URI
value matching the OJEU-Loc value in the 'Scheme information URI" (see clause 5.3.7 of ETSI
TS 119 612 [1]) field of LOTL, considering the first such URI as number 1.
b)    The processing shall set LOTLSO-Certs-Set to the full set of certificates as they are available in the tuple
from the 'Pointers to other TSLs' field (see clause 5.3.13 of ETSI TS 119 612 [1]) of Pivot, whose 'Scheme
territory' qualifier has the value "EU".
c)    If LOTLSO-Cert is not part of LOTLSO-Certs-Set then:
1)   the processing shall set Authenticated-LOTL to void;
2)   the processing shall set LOTL-Status to the value "LOTL_VERIFICATION_FAILED";
3)   the processing shall set LOTL-Sub-Status to the value "PIVOT_i-
1_SIGNER_CERT_NOT_AUTHENTICATED_BY_PIVOT_i"; and
4)   the processing shall stop the process.
d)    The processing shall set LOTLSO-Cert to the ds:X509Certificate value of the ds:KeyInfo of the
ds:Signature of Pivot.
e)    The processing shall validate ds:Signature of Pivot considering LOTLSO-Cert as a directly trusted
certificate, i.e. as a trust anchor.

> NOTE 6: This corresponds to the basic signature validation process of ETSI EN 319 102-1 [i.8].

f)    If the signature validation performed in the previous point failed or was indeterminate then:
1)   the processing shall set Authenticated-LOTL to void;
2)   the processing shall set LOTL-Status to the value "LOTL_VERIFICATION_FAILED";
3)   the processing shall set LOTL-Sub-Status to the values provided by the validation procedure
together with the additional value "PIVOT_i_SIGNATURE_VERIFICATION_FAILED"; and
4)   the processing shall stop the process.
g)    If LOTLSO-Cert is not part of LOTLSO-Certs-Set then:
1)   the processing shall set Authenticated-LOTL to void;
2)   the processing shall set LOTL-Status to the value "LOTL_VERIFICATION_FAILED";
3)   the processing shall set LOTL-Sub-Status to the value
"PIVOT_i_SIGNER_CERT_NOT_AUTHENTICATED_BY_PIVOT_i"; and
4)   the processing shall stop the process.
PRO-4.1.4-12: If LOTLSO-Cert is not part of LOTL-OJEU-Certs-Set then:
a)    the processing shall set Authenticated-LOTL to void;
b)    the processing shall set LOTL-Status to the value "LOTL_VERIFICATION_FAILED";
c)    the processing shall set LOTL-Sub-Status to the value
"PIVOT_n_LOTLSO_SIGNER_CERT_NOT_AUTHENTICATED_BY_OJEU"; and
d)    the processing shall stop the process.
PRO-4.1.4-13: If the 'Next update' date of LOTL (see clause 5.3.15 of ETSI TS 119 612 [1]) has passed then:
a)    the processing shall set Authenticated-LOTL to void;
b)    the processing shall set LOTL-Status to the value "LOTL_VERIFICATION_FAILED";
c)    the processing shall set LOTL-Sub-Status the value "LOTL_NEXTUPDATE_PASSED"; and
d)    the processing shall stop the process.
PRO-4.1.4-14: The processing shall set Authenticated-LOTL to LOTL.
PRO-4.1.4-15: The processing shall set LOTL-Status to the value "LOTL_VERIFICATION_PASSED".
PRO-4.1.4-16: If OJEU-LOTL-Loc is not matching the TSLLocation string available in the tuple from the 'Pointers to
other TSLs' field of Authenticated-LOTL (see clause 5.3.13 of ETSI TS 119 612 [1]) whose 'Scheme territory'
qualifier has the value "EU", then the processing shall set OJEU-LOTL-Loc to the TSLLocation string available in the
tuple from the 'Pointers to other TSLs' field of LOTL (see clause 5.3.13 of ETSI TS 119 612 [1]) whose 'Scheme
territory' qualifier has the value "EU".
PRO-4.1.4-17: If OJEU-Loc value is not matching the first URI value having an https scheme, an authority, and a
non-empty path not ending with the character string ".xml" in the 'Scheme information URI" (see clause 5.3.7 of ETSI
TS 119 612 [1]) field of Authenticated-LOTL, then:
a)    the processing shall set OJEU-Loc to that first URI value; and
b)    the processing shall set OJEU-LOTL-Certs-Set:
1)    either to the full set of certificates available in the tuple, whose 'Scheme territory' qualifier has the value
"EU", from the 'Pointers to other TSLs' field (see clause 5.3.13 of ETSI TS 119 612 [1]) of the pivot
LOTL whose location URI is immediately following that first URI value when having an https scheme,
an authority, and a non-empty path not ending with the character string ".xml"; or
2)    to the full set of certificates used for ensuring authenticity and integrity of the LOTL as provided in the
OJEU publication available from that first URI value.

### 4.2 Authenticating an EUMS trusted list


#### 4.2.1 Description

The procedure specified in clause 4.2 allows to obtain the authenticated XML version of the national TL of a given
EUMS.

#### 4.2.2 Inputs

Name                                                  Description
CC                           Country code of the EUMS for which the trusted list is to be authenticated and whose
value is in accordance with the ISO 3166-1 [2] Alpha 2 country code, set in capital
letters.

#### 4.2.3 Outputs

Name                                                       Description
Authenticated-EUTL           The authenticated XML version of the requested TL of EUMS CC.
EUTL-Status                  The status indication of the process of authenticating the requested TL of EUMS CC.
EUTL-Sub-Status              A list of indications supplementing EUTL-Status indication of the process of
authenticating the requested TL of EUMS CC.
OUT-4.2.3-01: All above listed output variables shall be initialized to void.

#### 4.2.4 Processing

PRO-4.2.4-01: The processing shall run the process for authenticating the LOTL as described in clause 4.1 of the
present document.
PRO-4.2.4-02: If the output Authenticated-LOTL is void as a result of the execution of the process referred in
PRO-4.2.4-01, then:
a)    the processing shall set EUTL-Status to the value "TL_VERIFICATION_FAILED";
b)    the processing shall set EUTL-Sub-Status to the values provided by set of values from LOTL-Status
and LOTL-Sub-Status; and
c)    the processing shall stop the process.
PRO-4.2.4-03: The processing shall set EUTL-Loc to the URI provided in the tuple from the 'Pointers to other TSLs'
field of Authenticated-LOTL (see clause 5.3.13 of ETSI TS 119 612 [1]) for which the 'Scheme territory'
qualifier has value CC and for which the 'MIME type' is XML.
PRO-4.2.4-04: The processing shall set EUTL to the XML file retrieved from EUTL-Loc.
PRO-4.2.4-05: The processing shall set EUTL-Certs-Set to the set of certificates provided in the tuple from the
'Pointers to other TSLs' field of Authenticated-LOTL (see clause 5.3.13 of ETSI TS 119 612 [1]) for which the
'Scheme territory' qualifier has value CC and for which the 'MIME type' is XML.
PRO-4.2.4-06: The processing shall set EUTL-Signer-Cert to the ds:X509Certificate value of the
ds:KeyInfo of the ds:Signature of EUTL.
PRO-4.2.4-07: If EUTL-Signer-Cert is not part of EUTL-Certs-Set, then:
a)    the processing shall set Authenticated-EUTL to void;
b)    the processing shall set EUTL-Status to the value "EUTL_VERIFICATION_FAILED";
c)    the processing shall set EUTL-Sub-Status to the value
"EUTLSO_SIGNER_CERT_NOT_AUTHENTICATED_BY_LOTL"; and
d)    the processing shall stop the process.
PRO-4.2.4-08: The processing shall validate ds:Signature of EUTL considering EUTL-Signer-Cert as a
directly trusted certificate, i.e. as a trust anchor.
PRO-4.2.4-09: If the signature validation performed in PRO-4.2.4-08 failed, then:
a)    the processing shall set Authenticated-EUTL to void;
b)    the processing shall set EUTL-Status to the value "EUTL_VERIFICATION_FAILED";
c)    the processing shall set EUTL-Sub-Status to the set of values provided by the validation procedure
together with the value "EUTL_SIGNATURE_VERIFICATION_FAILED"; and
d)    the processing shall stop the process.
PRO-4.2.4-10: If the 'Next update' date of EUTL (see clause 5.3.15 of ETSI TS 119 612 [1]) has passed, then the
processing shall add to EUTL-Sub-Status the value "WARNING_EUTL_NEXTUPDATE_PASSED".
PRO-4.2.4-11: The processing shall set Authenticated-EUTL to EUTL.
PRO-4.2.4-12: The processing shall set EUTL-Status to the value "EUTL_VERIFICATION_PASSED".

### 4.3 Obtaining listed services matching a certificate


#### 4.3.1 Description

The procedure specified in clause 4.3 allows to obtain, from the trusted list of a specific country, matching listed
services, associated service information for a certificate for a specific date and time, for a specific service type
identifier.

> NOTE:      The difference between a QTS type and a Service type identifier as specified in clause 5.5.1.1 of ETSI

TS 119 612 [1] may reside in the sub-definition of that identifier service type into sub-services defined
through 'additionalServiceInformation' extensions (see clause 5.5.9.4 of ETSI TS 119 612 [1]).

#### 4.3.2 Inputs

Name                                                      Description
CERT                     X.509 certificate for which the information is to be obtained (e.g. a ds:X509Certificate
value of a ds:KeyInfo of the ds:Signature)
TLS-Sti                  One of the Service type identifier URI values specified in clause 5.5.1.1 of ETSI
TS 119 612 [1].
Date-time                Date and time indication as specified in clause 5.1.3 of ETSI TS 119 612 [1].
CC                       Country code value in accordance with the ISO 3166-1 [2] Alpha 2 country code, set in
capital letters.

#### 4.3.3 Outputs

Name                                                          Description
SI-Results                A set of groups of elements, each group made of:
a) SI-full defined as an XML section corresponding to a 'Service information'
element as specified in clause 5.5 of ETSI TS 119 612 [1];
b) SI-at-Date-time defined as an XML section corresponding either to the
Date-time related 'Service (current) information' element as specified in
clause 5.5 of ETSI TS 119 612 [1] with the exception of clause 5.5.10 or to the
Date-time related 'Service history instance' element as specified in clause 5.6
of ETSI TS 119 612 [1];
c) TSP-Name defined as a 'TSP name' element as defined in clause 5.4.1 of ETSI
TS 119 612 [1]; and
d) TSP-Trade-Name defined as a 'TSP trade name' element as defined in
clause 5.4.2 of ETSI TS 119 612 [1].
SI-Status                 The status indication of the process consisting in obtaining for a certificate, for a specific
type of 'Service type identifier' URI value specified in clause 5.5.1.1 of ETSI TS 119 612 [1]
and for a specific date and time, a matching listed service and its associated service
information.
SI-Sub-Status             A list of indications supplementing SI-Status indication of the process.
OUT-4.3.3-01: All above listed output variables shall be initialized to void.

#### 4.3.4 Processing

PRO-4.3.4-01: If CC represents an EUMS and/or is set to "GB" or "UK":
a)    then the processing shall run the process for authenticating the EUMS trusted list from CC as described in
clause 4.2 of the present document, passing CC as input to the process;
b)    else:
1)      the processing shall set SI-Status to the value "PROCESS_FAILED";
2)      the processing shall set SI-Sub-Status to the value
"Provided_country_code_not_representing_an_EU_MS"; and
3)      the processing shall stop the process.
PRO-4.3.4-02: If the output Authenticated-EUTL is void as a result of the execution of the process referred in
PRO-4.3.4-01, then:
a)    the processing shall set SI-Status to the value "PROCESS_FAILED";
b)    the processing shall set SI-Sub-Status to the values provided by set of values from EUTL-Status and
EUTL-Sub-Status; and
c)    the processing shall stop the process.
PRO-4.3.4-03: For each 'Service information' entry (see clause 5.5 of ETSI TS 119 612 [1]) within
Authenticated-EUTL, the processing shall check whether:
i)    the 'Service type identifier' (see clause 5.5.1 of ETSI TS 119 612 [1]) matches TLS-Sti; and
ii)   either a certification path (see IETF RFC 5280 [4]) to CERT is found which, when using the 'Service digital
identity' public key and associated subject name of the entry as a trust anchor, validates successfully according
to section 6.1 of IETF RFC 5280 [4], with input (b) of section 6.1.1 set to Date-time and inputs (c) and (e)
to (i) set to the corresponding default values of the data type PathConstraints specified in Common PKI
v2.0 part 5 [5], Table 1; or the 'Service digital identity' public key and associated subject name are identical to
the public key and subject name in CERT;

> NOTE 1: In function of the TLS-Sti value, the length of the certification path can be "0", "1" or longer.


> NOTE 2: Name chaining is performed as part of the certificate path validation specified in clause 6 of IETF

RFC 5280 [4]. If no valid name chains are found from the subject distinguished name of one of the X.509
certificates present within the above 'Service digital identity' to the issuer distinguished name present
within CERT, then no valid certificate path will be built.

> NOTE 3: Although multiple X.509 certificates can be present within the above 'Service digital identity', they are

necessarily representing the same public key and have identical subject names in a trusted list compliant
to ETSI TS 119 612 [1].
and, when both checks succeed, shall add a tuple to SI-Results with:
a)   SI-full set to the entire such 'Service information' entry (see clause 5.5 of ETSI TS 119 612 [1]); and
b)   SI-at-Date-time set to:
-     either the entire such 'Service information' entry excepted, if any, the 'Service history' element (see
clause 5.5.10 of ETSI TS 119 612 [1]) when Date-time is greater than or equal to 'Current status
starting date and time' of that entry (see clause 5.5.5 of ETSI TS 119 612 [1]);
-     or the first 'Service history instance' (see clause 5.6 of ETSI TS 119 612 [1]) of that entry for which the
'Previous status starting date and time' (see clause 5.6.5 of ETSI TS 119 612 [1]) is less than or equal to
Date-time;
c)   TSP-Name set to the 'TSP name' element (see clause 5.4.1 of ETSI TS 119 612 [1]) associated to that 'Service
information' entry; and
d)   TSP-Trade-Name set to the 'TSP trade name' element (see clause 5.4.2 of ETSI TS 119 612 [1]) associated
to that 'Service information' entry.
PRO-4.3.4-03A: For each tuple in SI-Results, the processing shall check that the 'Service history instance'
elements in the corresponding SI-full element are correctly ordered:
a)   when this is not the case, the processing shall stop and report the error;
b)   when 'Service history instance' elements have the exact same 'Previous status starting date and time' value, the
processing shall stop and report the error.
PRO-4.3.4-04: The processing shall set SI-Status to the value "PROCESS_PASSED".
PRO-4.3.4-05: The processing shall add to SI-Sub-Status the indication value
"WARNING_T1_DUPLICATION" when two or more of the SI-Results tuples include an SI-at-Date-time
XML section for which:
a)   an 'additionalServiceInformation' extension (see clause 5.5.9.4 of ETSI TS 119 612 [1]) includes the value
http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForeSignatures; and
b)   values included in the respective 'Service current status' and/or 'Service previous status' fields (see respectively
clauses 5.5.4 and 5.6.4 of ETSI TS 119 612 [1]) are identical.
PRO-4.3.4-06: The processing shall add to SI-Sub-Status the indication value "ERROR_T1_DUPLICATION"
when two or more of the SI-Results tuples include an SI-at-Date-time XML section for which:
a)   an 'additionalServiceInformation' extension (see clause 5.5.9.4 of ETSI TS 119 612 [1]) includes the value
http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForeSignatures; and
b)   values included in the respective 'Service current status' and/or 'Service previous status' fields (see respectively
clauses 5.5.4 and 5.6.4 of ETSI TS 119 612 [1]) are not identical.
PRO-4.3.4-07: The processing shall add to SI-Sub-Status the indication value
"WARNING_T2_DUPLICATION" when two or more of the SI-Results tuples include an SI-at-Date-time
XML section for which:
a)   an 'additionalServiceInformation' extension (see clause 5.5.9.4 of ETSI TS 119 612 [1]) includes the value
http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForeSeals; and
b)    values included in the respective 'Service current status' and/or 'Service previous status' fields (see respectively
clauses 5.5.4 and 5.6.4 of ETSI TS 119 612 [1]) are identical.
PRO-4.3.4-08: The processing shall add to SI-Sub-Status the indication value "ERROR_T2_DUPLICATION"
when two or more of the SI-Results tuples include an SI-at-Date-time XML section for which:
a)    an 'additionalServiceInformation' extension (see clause 5.5.9.4 of ETSI TS 119 612 [1]) includes the value
http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForeSeals; and
b)    values included in the respective 'Service current status' and/or 'Service previous status' fields (see respectively
clauses 5.5.4 and 5.6.4 of ETSI TS 119 612 [1]) are not identical.
PRO-4.3.4-09: The processing shall add to SI-Sub-Status the indication value
"WARNING_T3_DUPLICATION" when two or more of the SI-Results tuples include an SI-at-Date-time
XML section for which:
a)    an 'additionalServiceInformation' extension (see clause 5.5.9.4 of ETSI TS 119 612 [1]) includes the value
http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForWebSiteAuthentication; and
b)    values included in the respective 'Service current status' and/or 'Service previous status' fields (see respectively
clauses 5.5.4 and 5.6.4 of ETSI TS 119 612 [1]) are identical.
PRO-4.3.4-10: The processing shall add to SI-Sub-Status the indication value "ERROR_T3_DUPLICATION"
when two or more of the SI-Results tuples include an SI-at-Date-time XML section for which:
a)    an 'additionalServiceInformation' extension (see clause 5.5.9.4 of ETSI TS 119 612 [1]) includes the value
http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForWebSiteAuthentication; and
b)    values included in the respective 'Service current status' and/or 'Service previous status' fields (see respectively
clauses 5.5.4 and 5.6.4 of ETSI TS 119 612 [1]) are not identical.
PRO-4.3.4-11: When two or more of the SI-Results tuples include different TSP-Name values, then:
a)    the processing shall add to SI-Sub-Status the indication value "ERROR_TSP_CONFLICT"; and
b)    the processing shall set SI-Status to the value "PROCESS_FAILED".

### 4.4 EU qualified certificate determination


#### 4.4.1 Description

The procedure specified in clause 4.4 allows determining whether a certificate is confirmed by the applicable EUMS
trusted list to have been an EU qualified certificate at a specific date and time and for which type.

#### 4.4.2 Inputs

Name                                                 Description of inputs
CERT                     X.509 certificate for which the information is to be obtained (e.g. a ds:X509Certificate
value of a ds:KeyInfo of the ds:Signature)
Date-time                Date and time indication as specified in clause 5.1.3 of ETSI TS 119 612 [1].

#### 4.4.3 Outputs

Name                                                           Description
QC-Results                      A set of indications of the EU qualified status of CERT through one or more of the
following values:
a) "Not_Qualified" to indicate that CERT is not an EU qualified certificate
according to the EUMS trusted list from CC at Date-time;
b) "Not_Qualified_For_eSig" to indicate that CERT is not an EU qualified
certificate for electronic signatures according to the EUMS trusted list from
CC at Date-time;
c) "Not_Qualified_For_eSeal" to indicate that CERT is not an EU qualified
certificate for electronic seals according to the EUMS trusted list from CC
at Date-time;
d) "Not_QWAC" to indicate that CERT is not an EU qualified certificate for
website authentication according to the EUMS trusted list from CC at
Date-time;
e) "QC_For_eSig" to indicate that CERT is an EU qualified certificate for
electronic signatures according to the EUMS trusted list from CC at Date-
time;
f) "QC_For_eSeal" to indicate that CERT is an EU qualified certificate for
electronic seals according to the EUMS trusted list from CC at Date-
time;
g) "QWAC" to indicate that CERT is an EU qualified certificate for web site
authentication according to the EUMS trusted list from CC at Date-time;
h) "INDET_QC_For_eSig" to indicate that the EUMS trusted list from CC
cannot be used to confirm that CERT is a qualified certificate for electronic
signatures at Date-time;
i) "INDET_QC_For_eSeal" to indicate that the EUMS trusted list from CC
cannot be used to confirm that CERT is a qualified certificate for electronic
seals at Date-time;
j) "INDET_QWAC" to indicate that the EUMS trusted list from CC cannot be
used to confirm that CERT is a qualified certificate for website
authentication at Date-time;
k) "INDETERMINATE";
l) Void.
QC-Status                       The status indication of the process.
QC-Sub-Status                   A list of indications supplementing QC-Status indication.
CHECK_1_SET-OF_QE               An intermediate result as defined in the process below.
CHECK_2_SET-OF_QE               An intermediate result as defined in the process below.
CHECK_3_SET-OF_QE               An intermediate result as defined in the process below.
OUT-4.4.3-01: All above listed output variables shall be initialized to void.

#### 4.4.4 Processing

PRO-4.4.4-01: The processing shall set CC to the country code value of the countryName attribute of the issuer
field of the certificate provided in CERT, in capital letters in accordance with the ISO 3166-1 [2] Alpha 2 country code,
with, when applicable:
a)    the country code value "GB" being converted to "UK";
b)    the country code value "GR" being converted to "EL".
PRO-4.4.4-02: The processing shall set TLS-Sti to the value "http://uri.etsi.org/TrstSvc/Svctype/CA/QC" as
specified in clause 5.5.1.1 of ETSI TS 119 612 [1].
PRO-4.4.4-03: The processing shall run the process described in clause 4.3 of the present document, passing the
following inputs to the process:
a)    CERT;
b)    TLS-Sti;
c)   Date-time;
d)   CC.
PRO-4.4.4-04: If the output SI-Status of the process run in PRO-4.4.4-03 has the value "PROCESS_FAILED",
then:
a)   the processing shall set QC-Status to the value "PROCESS_FAILED";
b)   the processing shall set QC-Sub-Status to the values provided by set of values from SI-Status and
SI-Sub-Status; and
c)   the processing shall stop the process.
PRO-4.4.4-05: If the output SI-Results of the process run in PRO-4.4.4-03 is void, then:
a)   the processing shall set QC-Status to the value "PROCESS_PASSED";
b)   the processing shall set QC-Sub-Status to the value "No_confirmation_found_in_EUMSTL_CC";
c)   the processing shall set QC-Results to the value "Not_Qualified"; and
d)   the processing shall stop the process.
PRO-4.4.4-06: When an organizationName attribute is present in the issuerName field of the certificate provided in
CERT, and performing matching verification between two names, naming attributes or distinguished names as specified
in clause 7.1 of IETF RFC 5280 [4]:
a)   then if the organizationName attribute of the issuerName field of the certificate provided in CERT is not
matching one of the values of TSP-Name or TSP-Trade-Name of the output SI-Results of the process
run in PRO-4.4.4-03, then:
1)    the processing shall set QC-Status to the value "PROCESS_FAILED";
2)    the processing shall set QC-Results to the value "INDETERMINATE";
3)    the processing shall set QC-Sub-Status to the value
"ERROR_TSP_NAME_INCONSISTENCY_BETWEEN_CERT_AND_TL"; and
4)    the processing shall stop the process;
b)   else the processing shall decide the strategy to verify that the legal or natural person having issued CERT is the
person identified by one of the values of TSP-Name or TSP-Trade-Name of the output SI-Results of
the process run in PRO-4.4.4-03 and in case of failure set QC-Status to the value "PROCESS_FAILED",
QC-Results to the value "INDETERMINATE", QC-Sub-Status to the value
"ERROR_TSP_NAME_INCONSISTENCY_BETWEEN_CERT_AND_TL" and shall stop the process.
EXAMPLE 1:       The strategy referred above can include:
i)   verification of the matching of the commonName attribute of the issuerName field of the
certificate provided in CERT with one of the values of TSP-Name or TSP-Trade-Name
of the output SI-Results of the process run in PRO-4.4.4-03; or
ii   verification of the matching of the distinguished name of the issuerName field of the
certificate provided in CERT with the distinguished name of the Sdi of the SI-full of the
output SI-Results of the process run in PRO-4.4.4-03.
PRO-4.4.4-07: When Date-time is before 2016-06-30T22:00:00Z, or when the date and time value of the
NotBeforeDate field of CERT is a value before 2016-06-30T22:00:00Z, the processing shall go to PRO-4.4.4-33.
PRO-4.4.4-08: The processing shall set the working variable CHECK_1 to void.

> NOTE 1: CHECK_1 is a variable defined as an indication whose possible values are the values present in Table 1.

PRO-4.4.4-09: If the output SI-Sub-Status of the process run in PRO-4.4.4-03 includes the value
"ERROR_T1_DUPLICATION", then the processing shall set CHECK_1 to the value "INDET_QC_For_eSig" and shall
go to PRO-4.4.4-16.

> NOTE 2: The above check could also catch the "WARNING_T1_DUPLICATION" case and treat it the same way

i.e. stopping the process and raising the warning. However, considering the trusted lists as legally
constitutive information regarding the qualified status of a trust service and hence of one of its output
(e.g. certificate, time stamp token, signed evidence), in the case the status information is consistent, the
relying party can decide, despite the fact that such a construction of the trusted list is in conflict with CID
(EU) 2015/1505 [i.2], to go further and still consider the information in the trusted list, provided no
further inconsistency is discovered in the rest of the processing (e.g. conflicting service information
qualifications extensions).
PRO-4.4.4-10: If none of the SI-at-Date-time element(s) of the SI-Results tuples (from the process run in
PRO-4.4.4-03) includes an 'additionalServiceInformation' extension (see clause 5.5.9.4 of ETSI TS 119 612 [1]) having
the value "http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForeSignatures" or if the 'Service current status' or 'Service
previous status' field of (any of) the SI-at-Date-time element(s) of the SI-Results tuples (from the process
run in PRO-4.4.4-03) that include an 'additionalServiceInformation' extension (see clause 5.5.9.4 of ETSI
TS 119 612 [1]) having the value "http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForeSignatures" has the value
"http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/withdrawn", then the processing shall set CHECK_1 to the value
"Not_Qualified_For_eSig" and shall go to PRO-4.4.4-16.
PRO-4.4.4-10A: If the 'Service current status' or 'Service previous status' field of (any of) the SI-at-Date-time
element(s) of the SI-Results tuples (from the process run in PRO-4.4.4-03) that include an
'additionalServiceInformation' extension (see clause 5.5.9.4 of ETSI TS 119 612 [1]) having the value
"http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForeSignatures" has a value different from either
"http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/granted" or
"http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/withdrawn", then:
a)    the processing shall add to QC-Sub-Status the value "ERROR_Service_Status_ Non-
compliance_with_TS119612";
b)    the processing shall set CHECK_1 to the value "INDET_QC_For_eSig"; and
c)    the processing shall go to PRO-4.4.4-16.
PRO-4.4.4-11: The processing shall set CHECK_1_SET-OF_QE to the set of all 'QualificationElement' from all
'Qualifications' extensions (see clause 5.5.9.2 of ETSI TS 119 612 [1]) whose 'CriteriaList' element identifies CERT
from all SI-at-Date-time elements of the SI-Results tuples (from the process run in PRO-4.4.4-03) that
include an 'additionalServiceInformation' extension (see clause 5.5.9.4 of ETSI TS 119 612 [1]) having the value
"http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForeSignatures".
PRO-4.4.4-12: The processing shall proceed as follows:
a)    it shall identify, if any, the set of all applicable qualifiers as per the content of the 'Qualifier' descendant
elements (see clause 5.5.9.2.3 of ETSI TS 119 612 [1]) of all 'QualificationElement' elements of
CHECK_1_SET-OF_QE.
In case one of the following qualifier or combinations is found, it shall set CHECK_1 to the value
"INDET_QC_For_eSig", it shall add to QC-Sub-Status the value
"WARNING_T1_TL_Inconsistency_in_applying_qualifiers", and it shall go to PRO-4.4.4-16:
1)    'QCForESeal' ("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForESeal");
2)    'QCForWSA' ("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForWSA");
3)    'NotQualified' ("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/NotQualified") and 'QCStatement'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCStatement");
4)    'QCForESig' ("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForESig") and 'QCForESeal'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForESeal");
5)    'QCForESig' ("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForESig") and 'QCForWSA'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForWSA");
6)   'QCForESeal' ("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForESeal") and 'QCForWSA'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForWSA"); or
7)   'QCForLegalPerson' ("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForLegalPerson").
PRO-4.4.4-13: The processing shall get the information about the presence and content of the id-etsi-qcs-
QcCompliance and id-etsi-qcs-QcType statements (see ETSI EN 319 412-5 [3], hereafter respectively QcCompliance
and QcType) in CERT.
PRO-4.4.4-14: If it results from PRO-4.4.4-13 that CERT includes more than one QcType identifier in its QcType
statement when present, then the processing shall add to QC-Sub-Status the value
"WARNING_CERT_Inconsistency_in_QcType_qualifiers_Non-compliance_with_EN319412-5".
PRO-4.4.4-15: Using the applicable qualifiers identified in PRO-4.4.4-12.(a):
a)    the processing shall check whether the following qualifiers are present among them: 'QCForESig'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForESig"), 'NotQualified'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/NotQualified") and 'QCStatement'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCStatement");
b)    the processing shall use the information obtained in PRO-4.4.4-13 to select the appropriate row of Table 1, and
shall use the information obtained in above point PRO-4.4.4-15.(a) to select the appropriate column of
Table 1;

> NOTE 3: Information in row1/column0 means, and corresponds to the case where, the QcCompliance statement is

present in CERT without any QcType statement being present, or the QcCompliance statement is present
in CERT together with QcType 1 statement. The meaning of the other rows of column0 can be deduced
accordingly.
Information in row0/column1 means, and corresponds to the case where, none of the three qualifiers
'NotQualified', 'QCStatement', 'QCForESig' in the 'Qualifications' extensions (denoted Sie:Q in Table 1)
applies to CERT (this also includes the case where no Sie:Q extension is present). Information in
row0/column5 means, and corresponds to the case where, both qualifiers 'QCStatement' and 'QCForESig'
in the 'Qualifications' extensions (denoted Sie:Q in Table 1) apply to CERT. The meaning of the other
columns of row0 can be deduced accordingly.
c)    the processing shall set CHECK_1 to the value found in the selected cell of Table 1;
EXAMPLE 2:        If QcCompliance extension is present in CERT together with the QcType 3 and the qualifier
'QCForESig' applies to CERT as per the applicable qualifiers, then the value set to CHECK_1 is
"QC_For_eSig" (see row3/column4).
d)    if row8/column3 of Table 1 was selected in step (b) above, then the processing shall add to QC-Sub-Status
the value "WARNING_T1_Not_Enough_Info_on_QC_Type".
Table 1: QC-For-eSig determination
Sie:aSI = ForeSignatures
None of Sie:Q          Sie:Q
Sie:Q
NotQualified        NotQualified              Sie:Q                 Sie:Q
QCStatement
QCStatement       (with or without        QCStatement             QCForESig
& QCForESig
row0                                  QCForESig          QCForESig)
QcCompliance or          “QC_For_eSig”
“Not_Qualified_For
“QC_For_eSig”          “QC_For_eSig”    “QC_For_eSig”
row1
QcCompliance + QcType 1                            _eSig”
QcCompliance         “Not_Qualified_For “Not_Qualified_For “Not_Qualified_For_
“QC_For_eSig”    “QC_For_eSig”
row2
+ QcType 2                _eSig”             _eSig”                 eSig”
QcCompliance         “Not_Qualified_For “Not_Qualified_For “Not_Qualified_For_
“QC_For_eSig”    “QC_For_eSig”
row3
+ QcType 3                _eSig”             _eSig”                 eSig”
QcCompliance         “INDET_QC_For_eSi “Not_Qualified_For “INDET_QC_For_eSig
“QC_For_eSig”    “QC_For_eSig”
row4
+ QcType 1 & QcType 2           g”                _eSig”                   ”
QcCompliance         “INDET_QC_For_eSi “Not_Qualified_For “INDET_QC_For_eSig
“QC_For_eSig”    “QC_For_eSig”
row5
+ QcType 1 & QcType 3           g”                _eSig”                   ”
QcCompliance         “Not_Qualified_For “Not_Qualified_For “Not_Qualified_For_
“QC_For_eSig”    “QC_For_eSig”
row6
+ QcType 2 & QcType 3          _eSig”             _eSig”                 eSig”
QcCompliance         “INDET_QC_For_eSi “Not_Qualified_For “INDET_QC_For_eSig
+ QcType 1 & QcType 2 &           g”               _eSig”                   ”
“QC_For_eSig”    “QC_For_eSig”
row7           QCType 3
no QcCompliance        “Not_Qualified_For “Not_Qualified_For “INDET_QC_For_eSig “Not_Qualified_For
“QC_For_eSig”
row8
and no QcType               _eSig”             _eSig”                   ”                  _eSig”
no QcCompliance        “Not_Qualified_For “Not_Qualified_For
“QC_For_eSig”
“Not_Qualified_For
“QC_For_eSig”
row9
+ QcType 1                _eSig”             _eSig”                                      _eSig”
no QcCompliance        “Not_Qualified_For “Not_Qualified_For “Not_Qualified_For_ “Not_Qualified_For
“QC_For_eSig”
row10
+ QcType 2                _eSig”             _eSig”                 eSig”                _eSig”
no QcCompliance        “Not_Qualified_For “Not_Qualified_For “Not_Qualified_For_ “Not_Qualified_For
“QC_For_eSig”
row11
+ QcType 3                _eSig”             _eSig”                 eSig”                _eSig”
no QcCompliance       “Not_Qualified_For “Not_Qualified_For “INDET_QC_For_eSig “Not_Qualified_For
“QC_For_eSig”
row12
+ QcType 1 & QcType 2          _eSig”             _eSig”                   ”                  _eSig”
no QcCompliance       “Not_Qualified_For “Not_Qualified_For “INDET_QC_For_eSig “Not_Qualified_For
“QC_For_eSig”
row13
+ QcType 1 & QcType 3          _eSig”             _eSig”                   ”                  _eSig”
no QcCompliance       “Not_Qualified_For “Not_Qualified_For “Not_Qualified_For_ “Not_Qualified_For
“QC_For_eSig”
row14
+ QcType 2 & QcType 3          _eSig”             _eSig”                 eSig”                _eSig”
no QcCompliance       “Not_Qualified_For “Not_Qualified_For “INDET_QC_For_eSig “Not_Qualified_For
+ QcType 1 & QcType 2 &         _eSig”             _eSig”                   ”                  _eSig”
“QC_For_eSig”
row15           QCType 3
column0                 column1            column2               column3               column4          column5
PRO-4.4.4-16: The processing shall set the working variable CHECK_2 to void.

> NOTE 4: CHECK_2 is a variable defined as an indication whose possible values are the values present in Table 2.

PRO-4.4.4-17: If the output SI-Sub-Status of the process run in PRO-4.4.4-03 includes the value
"ERROR_T2_DUPLICATION", then the processing shall set CHECK_2 to the value "INDET_QC_For_eSeal" and
shall go to PRO-4.4.4-24.

> NOTE 5: The above check could also catch the "WARNING_T2_DUPLICATION" case and treat it the same way

i.e. stopping the process and raising the warning. However, considering the trusted lists as legally
constitutive information regarding the qualified status of a trust service and hence of one of its output
(e.g. certificate, time stamp token, signed evidence), in the case the status information is consistent, the
relying party can decide, despite the fact that such a construction of the trusted list is in conflict with
CID (EU) 2015/1505 [i.2], to go further and still consider the information in the trusted list, provided no
further inconsistency is discovered in the rest of the processing (e.g. conflicting service information
qualifications extensions).
PRO-4.4.4-18: If none of the SI-at-Date-time element(s) of the SI-Results tuples (from the process run in
PRO-4.4.4-03) includes an 'additionalServiceInformation' extension (see clause 5.5.9.4 of ETSI TS 119 612 [1]) having
the value "http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForeSeals" or if the 'Service current status' or 'Service
previous status' field of (any of) the SI-at-Date-time elements of the SI-Results tuples (from the process run
in PRO-4.4.4-03) that include an 'additionalServiceInformation' extension (see clause 5.5.9.4 of ETSI TS 119 612 [1])
having the value "http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForeSeals" has the value
"http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/withdrawn", then the processing shall set CHECK_2 to the value
"Not_Qualified_For_eSeal" and shall go to PRO-4.4.4-24.
PRO-4.4.4-18A: If the 'Service current status' or 'Service previous status' field of (any of) the SI-at-Date-time
element(s) of the SI-Results tuples (from the process run in PRO-4.4.4-03) that include an
'additionalServiceInformation' extension (see clause 5.5.9.4 of ETSI TS 119 612 [1]) having the value
"http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForeSeals" a value different from either
"http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/granted", or
"http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/withdrawn", then:
a)    the processing shall add to QC-Sub-Status the value "ERROR_Service_Status_
Non-compliance_with_TS119612";
b)    the processing shall set CHECK_1 to the value "INDET_QC_For_eSeal"; and
c)    the processing shall go to PRO-4.4.4-24.
PRO-4.4.4-19: The processing shall set CHECK_2_SET-OF_QE to the set of all 'QualificationElement' from all
'Qualifications' extensions (see clause 5.5.9.2 of ETSI TS 119 612 [1]) whose 'CriteriaList' element identifies CERT
from all SI-at-Date-time elements of the SI-Results tuples (from the process run in PRO-4.4.4-03) that
include an 'additionalServiceInformation' extension (see clause 5.5.9.4 of ETSI TS 119 612 [1]) having the value
"http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForeSeals".
PRO-4.4.4-20: The processing shall proceed as follows:
a)    it shall identify, if any, the set of all applicable qualifiers as per the content of the 'Qualifier' descendant
elements (see clause 5.5.9.2.3 of ETSI TS 119 612 [1]) of all 'QualificationElement' elements of
CHECK_2_SET-OF_QE;
b)    in case one of the following qualifier or combinations is found, it shall set CHECK_2 to the value
"INDET_QC_For_eSeal", it shall add to QC-Sub-Status the value
"WARNING_T2_TL_Inconsistency_in_applying_qualifiers", and it shall go to PRO-4.4.4-24:
1)    'QCForESig' ("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForESig");
2)    'QCForWSA' ("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForWSA");
3)    'NotQualified' ("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/NotQualified") and 'QCStatement'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCStatement");
4)    'QCForESig' ("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForESig") and 'QCForESeal'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForESeal");
5)    'QCForESig' ("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForESig") and 'QCForWSA'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForWSA"); or
6)    'QCForESeal' ("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForESeal") and 'QCForWSA'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForWSA").
PRO-4.4.4-21: The processing shall get the information about the presence and content of the QcCompliance and
QcType statements (see ETSI EN 319 412-5 [3]) in CERT.
PRO-4.4.4-22: If it results from PRO-4.4.4-21 that CERT includes more than one QcType identifier in its QcType
statement when present, then the processing shall add to QC-Sub-Status the value
"WARNING_CERT_Inconsistency_in_QcType_qualifiers_Non-compliance_with_EN319412-5".
PRO-4.4.4-23: Using the applicable qualifiers identified in PRO-4.4.4-20.(a):
a)    the processing shall check whether the following qualifiers are present among them: 'QCForESeal'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForESeal"), 'NotQualified'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/NotQualified") and 'QCStatement'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCStatement");
b)    the processing shall use the information obtained in PRO-4.4.4-21 to select the appropriate row of Table 2, and
shall use the information obtained in above point PRO-4.4.4-23.(a) to select the appropriate column of
Table 2;

> NOTE 6: Information in row1/column0 means, and corresponds to the case where, the QcCompliance statement is

present in CERT without any QcType statement being present, or the QcCompliance statement is present
in CERT together with QcType 1 statement. The meaning of the other rows of column0 can be deduced
accordingly.
Information in row0/column1 means, and corresponds to the case where, none of the three qualifiers
'NotQualified', 'QCStatement', 'QCForESeal' in the 'Qualifications' extensions (denoted Sie:Q in Table 2)
applies to CERT (this also includes the case where no Sie:Q extension is present). Information in
row0/column5 means, and corresponds to the case where, both qualifiers 'QCStatement' and
'QCForESeal' in the 'Qualifications' extensions apply to CERT. The meaning of the other columns of row0
can be deduced accordingly.
c)    the processing shall set CHECK_2 to the value found in the selected cell of Table 2;
EXAMPLE 3:        If QcCompliance extension is present in CERT together with the QcType 3 and the qualifier
'QCForESeal' applies to CERT as per the applicable qualifiers, then the value set to CHECK_2 is
"QC_For_eSeal" (see row3/column4).
d)    if row8/column3 of Table 2 was selected in step (b) above, then the processing shall add to QC-Sub-Status
the value "WARNING_T2_Not_Enough_Info_on_QC_Type".
Table 2: QC-For-eSeal determination
Sie:aSI = ForeSeals
None of Sie:Q          Sie:Q
Sie:Q
NotQualified       NotQualified            Sie:Q                 Sie:Q
QCStatement
QCStatement       (with or without      QCStatement            QCForESeal
& QCForESeal
row0                                 QCForESeal         QCForESeal)
QcCompliance or        “Not_Qualified_For “Not_Qualified_For “Not_Qualified_For_
“QC_For_eSeal”      “QC_For_eSeal”
row1
QcCompliance + QcType 1        _eSeal”            _eSeal”               eSeal”
QcCompliance          “QC_For_eSeal”
“Not_Qualified_For
“QC_For_eSeal”        “QC_For_eSeal”      “QC_For_eSeal”
row2
+ QcType 2                                  _eSeal”
QcCompliance         “Not_Qualified_For “Not_Qualified_For “Not_Qualified_For_
“QC_For_eSeal”      “QC_For_eSeal”
row3
+ QcType 3               _eSeal”            _eSeal”               eSeal”
QcCompliance         “INDET_QC_For_eSe “Not_Qualified_For “INDET_QC_For_eSe
“QC_For_eSeal”      “QC_For_eSeal”
row4
+ QcType 1 & QcType 2           al”              _eSeal”                 al”
QcCompliance         “Not_Qualified_For “Not_Qualified_For “Not_Qualified_For_
“QC_For_eSeal”      “QC_For_eSeal”
row5
+ QcType 1 & QcType 3         _eSeal”            _eSeal”               eSeal”
QcCompliance         “INDET_QC_For_eSe “Not_Qualified_For “INDET_QC_For_eSe
“QC_For_eSeal”      “QC_For_eSeal”
row6
+ QcType 2 & QcType 3           al”              _eSeal”                 al”
QcCompliance         “INDET_QC_For_eSe “Not_Qualified_For “INDET_QC_For_eSe
+ QcType 1 & QcType 2 &          al”              _eSeal”                 al”
“QC_For_eSeal”      “QC_For_eSeal”
row7           QCType 3
no QcCompliance        “Not_Qualified_For “Not_Qualified_For “INDET_QC_For_eSe “Not_Qualified_For
“QC_For_eSeal”
row8
and no QcType              _eSeal”            _eSeal”                 al”                _eSeal”
no QcCompliance        “Not_Qualified_For “Not_Qualified_For “Not_Qualified_For_ “Not_Qualified_For
“QC_For_eSeal”
row9
+ QcType 1               _eSeal”            _eSeal”               eSeal”               _eSeal”
no QcCompliance        “Not_Qualified_For “Not_Qualified_For
“QC_For_eSeal”
“Not_Qualified_For
“QC_For_eSeal”
row10
+ QcType 2               _eSeal”            _eSeal”                                    _eSeal”
no QcCompliance        “Not_Qualified_For “Not_Qualified_For “Not_Qualified_For_ “Not_Qualified_For
“QC_For_eSeal”
row11
+ QcType 3               _eSeal”            _eSeal”               eSeal”               _eSeal”
no QcCompliance       “Not_Qualified_For “Not_Qualified_For “INDET_QC_For_eSe “Not_Qualified_For
“QC_For_eSeal”
row12
+ QcType 1 & QcType 2         _eSeal”            _eSeal”                 al”                _eSeal”
no QcCompliance       “Not_Qualified_For “Not_Qualified_For “Not_Qualified_For_ “Not_Qualified_For
“QC_For_eSeal”
row13
+ QcType 1 & QcType 3         _eSeal”            _eSeal”               eSeal”               _eSeal”
no QcCompliance       “Not_Qualified_For “Not_Qualified_For “INDET_QC_For_eSe “Not_Qualified_For
“QC_For_eSeal”
row14
+ QcType 2 & QcType 3         _eSeal”            _eSeal”                 al”                _eSeal”
no QcCompliance       “Not_Qualified_For “Not_Qualified_For “INDET_QC_For_eSe “Not_Qualified_For
+ QcType 1 & QcType 2 &        _eSeal”            _eSeal”                 al”                _eSeal”
“QC_For_eSeal”
row15           QCType 3
column0                 column1            column2              column3               column4            column5
PRO-4.4.4-24: The processing shall set the working variable CHECK_3 to void.

> NOTE 7: CHECK_3 is a variable defined as an indication whose possible values are the values present in Table 3.

PRO-4.4.4-25: If the output SI-Sub-Status of the process run in PRO-4.4.4-03 includes the value
"ERROR_T3_DUPLICATION", then the processing shall set CHECK_3 to the value "INDET_QWAC" and shall go to
PRO-4.4.4-32.

> NOTE 8: The above check could also catch the "WARNING_T3_DUPLICATION" case and treat it the same way

i.e. stopping the process and raising the warning. However, considering the trusted lists as legally
constitutive information regarding the qualified status of a trust service and hence of one of its output
(e.g. certificate, time stamp token, signed evidence), in the case the status information is consistent, the
relying party can decide, despite the fact that such a construction of the trusted list is in conflict with
CID (EU) 2015/1505 [i.2], to go further and still consider the information in the trusted list, provided no
further inconsistency is discovered in the rest of the processing (e.g. conflicting service information
qualifications extensions).
PRO-4.4.4-26: If none of the SI-at-Date-time element(s) of the SI-Results tuples (from the process run in
PRO-4.4.4-03) includes an 'additionalServiceInformation' extension (see clause 5.5.9.4 of ETSI TS 119 612 [1]) having
the value "http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForWebSiteAuthentication" or if the 'Service current
status' or 'Service previous status' field of (any of) the SI-at-Date-time elements of the SI-Results tuples
(from the process run in PRO-4.4.4-03) that include an 'additionalServiceInformation' extension (see clause 5.5.9.4 of
ETSI TS 119 612 [1]) having the value "http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForWebSiteAuthentication"
has the value "http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/withdrawn", then the processing shall set CHECK_3 to
the value "Not_QWAC" and shall go to PRO-4.4.4-32.
PRO-4.4.4-26A: If the 'Service current status' or 'Service previous status' field of (any of) the SI-at-Date-time
element(s) of the SI-Results tuples (from the process run in PRO-4.4.4-03) that include an
'additionalServiceInformation' extension (see clause 5.5.9.4 of ETSI TS 119 612 [1]) having the value
"http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForWebSiteAuthentication" or a value different from either
"http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/granted", or
"http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/withdrawn", then:
a)    the processing shall add to QC-Sub-Status the value "ERROR_Service_Status_ Non-
compliance_with_TS119612";
b)    the processing shall set CHECK_1 to the value "INDET_QWAC"; and
c)    the processing shall go to PRO-4.4.4-32.
PRO-4.4.4-27: The processing shall set CHECK_3_SET-OF_QE to the set of all 'QualificationElement' from all
'Qualifications' extensions (see clause 5.5.9.2 of ETSI TS 119 612 [1]) whose 'CriteriaList' element identifies CERT
from all SI-at-Date-time elements of the SI-Results tuples (from the process run in PRO-4.4.4-03) that
include an 'additionalServiceInformation' extension (see clause 5.5.9.4 of ETSI TS 119 612 [1]) having the value
"http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForWebSiteAuthentication".
PRO-4.4.4-28: The processing shall proceed as follows:
a)    it shall identify, if any, the set of all applicable qualifiers as per the content of the 'Qualifier' descendant
elements (see clause 5.5.9.2.3 of ETSI TS 119 612 [1]) of all 'QualificationElement' elements of
CHECK_3_SET-OF_QE;
b)    in case one of the following qualifier or combinations is found, it shall set CHECK_3 to the value
"INDET_QWAC", it shall add to QC-Sub-Status the value
"WARNING_T3_TL_Inconsistency_in_applying_qualifiers", and it shall go to PRO-4.4.4-32:
1)    'QCForESig' ("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForESig");
2)    'QCForESeal' ("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForESeal");
3)    'NotQualified' ("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/NotQualified") and 'QCStatement'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCStatement");
4)    'QCForESig' ("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForESig") and 'QCForESeal'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForESeal");
5)    'QCForESig' ("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForESig") and 'QCForWSA'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForWSA"); or
6)    'QCForESeal' ("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForESeal") and 'QCForWSA'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForWSA").
PRO-4.4.4-29: The processing shall get the information about the presence and content of the QcCompliance and
QcType statements (see ETSI EN 319 412-5 [3]) in CERT.
PRO-4.4.4-30: If it results from PRO-4.4.4-29 that CERT includes more than one QcType identifier in its QcType
statement when present, then the processing shall add to QC-Sub-Status the value
"WARNING_CERT_Inconsistency_in_QcType_qualifiers_Non-compliance_with_EN319412-5".
PRO-4.4.4-31: Using the applicable qualifiers identified in PRO-4.4.4-28.(a):
a)    the processing shall check whether the following qualifiers are present among them: 'QCForWSA'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForWSA"), 'NotQualified'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/NotQualified") and 'QCStatement'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCStatement");
b)    the processing shall use the information obtained in PRO-4.4.4-29 to select the appropriate row of Table 3, and
it shall use the information obtained in above point PRO-4.4.4-31.(a) to select the appropriate column of
Table 3;

> NOTE 9: Information in row1/column0 means, and corresponds to the case where, the QcCompliance statement is

present in CERT without any QcType statement being present, or the QcCompliance statement is present
in CERT together with QcType 1 statement. The meaning of the other rows of column0 can be deduced
accordingly.
Information in row0/column1 means, and corresponds to the case where, none of the three qualifiers
'NotQualified', 'QCStatement', 'QCForWSA' in the 'Qualifications' extensions (denoted Sie:Q in Table 3)
applies to CERT (this also includes the case where no Sie:Q extension is present). Information in
row0/column5 means, and corresponds to the case where, both qualifiers 'QCStatement' and 'QCForWSA'
in the 'Qualifications' extensions apply to CERT. The meaning of the other columns of row0 can be
deduced accordingly.
c)    the processing shall set CHECK_3 to the value found in the selected cell of Table 3;
EXAMPLE 4:        If QcCompliance extension is present in CERT together with the QcType 3 and the qualifier
'QCForWSA' applies to CERT as per the applicable qualifiers, then the value set to CHECK_3 is
"QWAC" (see row3/column4).
Table 3: QC-For-WebSiteAuthentication determination
Sie:aSI = ForWebSiteAuthentication
None of Sie:Q        Sie:Q
Sie:Q
NotQualified    NotQualified              Sie:Q                   Sie:Q
QCStatement
QCStatement     (with or without       QCStatement            QCForWSA
& QCForWSA
row0                                      QCForWSA         QCForWSA)
QcCompliance
or                “Not_QWAC”       “Not_QWAC”            “Not_QWAC”                 “QWAC”     “QWAC”
row1         QcCompliance + QcType 1
QcCompliance + QcType 2     “Not_QWAC”       “Not_QWAC”            “Not_QWAC”                 “QWAC”     “QWAC”
row2
QcCompliance + QcType 3       "QWAC"         “Not_QWAC”               “QWAC”                  “QWAC”     “QWAC”
row3
QcCompliance           “Not_QWAC”       “Not_QWAC”            “Not_QWAC”                 “QWAC”     “QWAC”
+ QcType 1 & QcType 2
row4
QcCompliance           "INDET_QWAC”     “Not_QWAC”           "INDET_QWAC”                “QWAC”     “QWAC”
+ QcType 1 & QcType 3
row5
QcCompliance           "INDET_QWAC”     “Not_QWAC”           "INDET_QWAC”                “QWAC”     “QWAC”
+ QcType 2 & QcType 3
row6
QcCompliance
+ QcType 1 & QcType 2 & QCType   "INDET_QWAC”     “Not_QWAC”           "INDET_QWAC”                “QWAC”     “QWAC”
row7                   3
no QcCompliance          “Not_QWAC”       “Not_QWAC”           "INDET_QWAC”           “Not_QWAC”      “QWAC”
and no QcType
row8
no QcCompliance          “Not_QWAC”       “Not_QWAC”            “Not_QWAC”            “Not_QWAC”      “QWAC”
+ QcType 1
row9
no QcCompliance          “Not_QWAC”       “Not_QWAC”            “Not_QWAC”            “Not_QWAC”      “QWAC”
+ QcType 2
row10
no QcCompliance          “Not_QWAC”       “Not_QWAC”               “QWAC”             “Not_QWAC”      “QWAC”
+ QcType 3
row11
no QcCompliance         “Not_QWAC”       “Not_QWAC”            “Not_QWAC”            “Not_QWAC”      “QWAC”
+ QcType 1 & QcType 2
row12
no QcCompliance         “Not_QWAC”       “Not_QWAC”           "INDET_QWAC”           “Not_QWAC”      “QWAC”
+ QcType 1 & QcType 3
row13
no QcCompliance         “Not_QWAC”       “Not_QWAC”           "INDET_QWAC”           “Not_QWAC”      “QWAC”
+ QcType 2 & QcType 3
row14
no QcCompliance
+ QcType 1 & QcType 2 & QCType     “Not_QWAC”       “Not_QWAC”           "INDET_QWAC”           “Not_QWAC”      “QWAC”
row15                3
column0                column1          column2                column3                 column4    column5
d)      if row8/column3 of Table 3 was selected in step (b) above, then the processing shall add to QC-Sub-Status
the value "WARNING_T3_Not_Enough_Info_on_QC_Type".
PRO-4.4.4-32: The processing shall compare two by two the values of CHECK_1, CHECK_2, and CHECK_3 on the
basis of Table 4 as follows:
a)      when the comparison results in an "error" indication:
1)      the processing shall set QC-Status to the value "PROCESS_FAILED";
2)      the processing shall add to QC-Sub-Status appropriate values reflecting the problematic two by two
combinations; and
3)      the processing shall stop the process;
b)      the processing shall set QC-Status to the value "PROCESS_PASSED";
c)   the processing shall set QC-Results to the set of indications provided in CHECK_1, in CHECK_2, and in
CHECK_3;
d)   when the comparison results in one or more "warning" indications:
1)   the processing shall set QC-Status to the value "PROCESS_PASSED_WITH_WARNING";
2)   the processing shall add to QC-Sub-Status appropriate values reflecting the problematic two by two
combinations;
Table 4: QC status check
e)   the processing shall go to PRO-4.4.4-34.
PRO-4.4.4-33: Proceed as follows:
a)   the processing shall set CHECK_2 to the value "Not_Qualified_For_eSeal";
b)   the processing shall set CHECK_3 to the value "Not_QWAC";
c)   if there are two or more of the SI-Results tuples (from the process run in PRO-4.4.4-03) that include an
SI-at-Date-time XML section for which the values included in the 'Service previous status' fields (see
clause 5.6.4 of ETSI TS 119 612 [1]) are identical, then the processing shall add to QC-Sub-Status the
indication value "WARNING_TL-SERVICE-ENTRY-SDI_DUPLICATION";
d)   if there are two or more of the SI-Results tuples that include an SI-at-Date-time XML section for
which the values included in the 'Service previous status' fields (see clause 5.6.4 of ETSI TS 119 612 [1]) are
not identical, then:
1)   the processing shall add to QC-Sub-Status the indication value "ERROR_TL-SERVICE-ENTRY-
SDI_DUPLICATION_STATUS_CONFLICT";
2)   the processing shall set QC-Status to the value "PROCESS_FAILED";
3)   the processing shall stop the process;
e)   the processing shall set CHECK_1 to void;
f)   the processing shall proceed as follow:
1)   when Date-time is before 2016-06-30T22:00:00Z, the processing shall check if the 'Service previous
status' field of (any of) the SI-at-Date-time element(s) of the SI-Results tuples has one of the
values "http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/supervisionceased",
"http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/supervisionrevoked",
"http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/accreditationceased", or
"http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/accreditationrevoked";
2)   when Date-time is after 2016-06-30T22:00:00Z, the processing shall check if none of the
SI-at-Date-time element(s) of the SI-Results tuples (from the process run in PRO-4.4.4-03)
includes an 'additionalServiceInformation' extension (see clause 5.5.9.4 of ETSI TS 119 612 [1]) having
the value "http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForeSignatures" or if the 'Service current
status' or 'Service previous status' field of (any of) the SI-at-Date-time element(s) of the
SI-Results tuples (from the process run in PRO-4.4.4-03) that include an
'additionalServiceInformation' extension (see clause 5.5.9.4 of ETSI TS 119 612 [1]) having the value
"http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForeSignatures" has the value
"http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/withdrawn";
3)   if the check performed in point 1) or 2) above was successful, then:
i)     the processing shall set CHECK_1 to the value "Not_Qualified_For_eSig";
ii)    the processing shall set QC-Status to the value "PROCESS_PASSED";
iii)   the processing shall stop the process;
g)   the processing shall set CHECK_1_SET-OF_QE to the set of all 'QualificationElement' from all
'Qualifications' extensions (see clause 5.5.9.2 of ETSI TS 119 612 [1]) whose 'CriteriaList' element identifies
CERT from all SI-at-Date-time elements of the SI-Results tuples (from the process run in
PRO-4.4.4-03);
h)   the processing shall proceed as follows:
1)   it shall identify the set of all applicable qualifiers as per the content of the 'Qualifier' descendant elements
(see clause 5.5.9.2.3 of ETSI TS 119 612 [1]) of all 'QualificationElement' elements of CHECK_1_SET-
OF_QE;
2)   in case the qualifier "http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForESeal", the qualifier
"http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCForWSA", and/or combination of the qualifiers
"http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/NotQualified" and
"http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCStatement" is/are found, then:
i)     the processing shall set CHECK_1 to the value "INDET_QC_For_eSig";
ii)    the processing shall add to QC-Sub-Status the value
"ERROR_T1_TL_Inconsistency_in_applying_qualifiers";
iii)   the processing shall set QC-Status to the value "PROCESS_FAILED";
iv)    the processing shall stop the process;
i)   the processing shall get the information about the presence in CERT of the id-etsi-qcs-QcCompliance
statement (see ETSI EN 319 412-5 [3]), the 0.4.0.1456.1.1 (QCP+) ETSI defined certificate policy OID,
and/or the 0.4.0.1456.1.2 (QCP) ETSI defined certificate policy OID;
j)   the processing shall use the applicable qualifiers identified in PRO-4.4.4-33.(h).a to select the appropriate
column of Table 5, and shall use the information obtained in PRO-4.4.4-33.(i) to select the appropriate row of
Table 5;
Table 5: QC-For-eSig determination under Directive 1999/93/EC [i.7]
Sti = CA/QC
None of Sie:Q
Sie:Q                      Sie:Q
NotQualified
NotQualified               QCStatement
row0                                           QCStatement
QcCompliance                 “QC_For_eSig”          “Not_Qualified_For_eSig”        “QC_For_eSig”
row1
PolicyId QCP                “QC_For_eSig”          “Not_Qualified_For_eSig”        “QC_For_eSig”
(qcp-public)
row2
PolicyId QCP+                “QC_For_eSig”          “Not_Qualified_For_eSig”        “QC_For_eSig”
(qcp-public-with-sscd)
row3
Any combination of
QcCompliance, PolicyId QCP,        “QC_For_eSig”          “Not_Qualified_For_eSig”        “QC_For_eSig”
row4             PolicyId QCP+
None                “Not_Qualified_For_eSig”    “Not_Qualified_For_eSig”        “QC_For_eSig”
row5
column0                     column1                     column2                    column3

> NOTE 10: Information in row1/column0 means, and corresponds to the case where, the QcCompliance statement is

present in CERT. The meaning of the other rows of column0 can be deduced accordingly. Information in
row0/column1 means, and corresponds to the case where, none of the qualifiers 'NotQualified' or
'QCStatement' in the 'Qualifications' extensions (denoted Sie:Q in Table 5) applies to CERT. The meaning
of the other columns of row0 can be deduced accordingly.
k)      the processing shall set CHECK_1 to the value found in the selected cell of Table 5;
l)      the processing shall set QC-Status to the value "PROCESS_PASSED";
m)      the processing shall set QC-Results to the set of indications provided in CHECK_1, in CHECK_2, and in
CHECK_3.
PRO-4.4.4-34: The processing shall run the process described in clause 4.4 of the present document, until either
PRO-4.4.4-32 step is completed or PRO-4.4.4-33 step is completed, passing the following inputs to the process:
a)      CERT;
b)      the date and time value of the NotBeforeDate field of CERT.
PRO-4.4.4-35: If the output QC-Status of the process run in PRO-4.4.4-34 has the value "PROCESS_FAILED",
then:
a)      the processing shall set QC-Status to the value "PROCESS_FAILED";
b)      the processing shall add to QC-Sub-Status the values provided by set of values from QC-Status and
QC-Sub-Status from the process run in PRO-4.4.4-34; and
c)      the processing shall stop the process.
PRO-4.4.4-36: The processing shall compare the values of QC-Results obtained after the first run of process 4.4
(with Date-time from the input) and after the second run of process 4.4 (with the NotBeforeDate):
a)      when the two results do not contain the exact same set of indications then:
1)     the processing shall set QC-Status to the value "PROCESS_FAILED";
2)     the processing shall add to QC-Sub-Status appropriate values reflecting the problematic
comparison(s); and
3)    the processing shall stop the process;

> NOTE 11: When QC-Results include either "QC_For_eSig", or "QC_For_eSeal" or "QWAC", then CERT can be

considered, at Date-time, respectively as an EU qualified certificate for electronic signatures, an EU
qualified certificate for electronic seals, or an EU qualified certificate for website authentication.
b)    when the QC-Sub-Status returned by the process run in PRO-4.4.4-34 contains one or more "warning"
indications:
1)    the processing shall set QC-Status to the value "PROCESS_PASSED_WITH_WARNING";
2)    the processing shall add to QC-Sub-Status the values provided by the set of values from
QC-Status and QC-Sub-Status from the process run in PRO-4.4.4-34.

### 4.5 QSCD determination


#### 4.5.1 Description

The procedure specified in clause 4.5 allows determining whether an EU qualified certificate is confirmed by the
applicable EUMS trusted list to have had its private key residing in a QSCD at a specific date and time.

> NOTE:      As the EUMS trusted list provides such information only for qualified certificates of a certain type, the

process will first determine whether or not the certificate is a qualified certificate and for which type.

#### 4.5.2 Inputs

Name                                                 Description of inputs
CERT                     X.509 certificate for which the information is to be obtained (e.g. a ds:X509Certificate
value of a ds:KeyInfo of the ds:Signature).
Date-time                Date and time indication as specified in clause 5.1.3 of ETSI TS 119 612 [1].

#### 4.5.3 Outputs

Name                                                          Description
QSCD-Results             An indication on whether CERT had its private key residing in a QSCD in accordance with
the trusted lists, through one of the following values:
a) "QSCD_YES" to indicate that CERT had its private key residing in a QSCD at
Date-time according to the EUMS trusted lists;
b) "QSCD_NO" to indicate that CERT did not have its private key residing in a QSCD
at Date-time according to the EUMS trusted lists;
c) "QSCD_INDETERMINATE" to indicate that the EUMS trusted lists cannot be
used to confirm whether CERT had its private key residing in a QSCD at
Date-time;
d) Void.
QSCD-Status              The status indication of the process.
QSCD-Sub-Status          A list of indications supplementing QSCD-Status indication.
OUT-4.5.3-01: All above listed output variables shall be initialized to void.

#### 4.5.4 Processing

PRO-4.5.4-01: The processing shall run the process described in clause 4.4 of the present document, passing the
following inputs to the process:
a)    CERT;
b)    Date-time.
PRO-4.5.4-02: If the output QC-Status of the process run in PRO-4.5.4-01 has the value "PROCESS_FAILED",
then:
a)    the processing shall set QSCD-Status to the value "PROCESS_FAILED";
b)    the processing shall set QSCD-Sub-Status to the values provided by set of values from QC-Status and
QC-Sub-Status; and
c)    the processing shall stop the process.
PRO-4.5.4-03: When Date-time is strictly before 2016-06-30T22:00:00Z:
a)    If QC_Results includes the value "QC_For_eSig", then considering CHECK_1_SET-OF_QE as part of the
outputs of the process run in PRO-4.5.4-01:
1)    the processing shall identify the set of all applicable qualifiers as per the content of the 'Qualifier'
descendant elements (see clause 5.5.9.2.3 of ETSI TS 119 612 [1]) of all 'QualificationElement' elements
of CHECK_1_SET-OF_QE, and shall check whether the following qualifiers are present among them:
'QCWithSSCD' ("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCWithSSCD"), 'QCNoSSCD'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCNoSSCD"), and 'QCSSCDStatusAsInCert'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCSSCDStatusAsInCert");
2)    in case one of the following combinations is found, the processing shall set QSCD-Results to the
value "QSCD_INDETERMINATE", shall set QSCD-Status to the value
"PROCESS_PASSED_WITH_WARNING", shall add to QSCD-Sub-Status the value
"WARNING_Inconsistency_in_applying_qualifiers_for_SSCD_status", and shall stop the process:
i)      'QCWithSSCD' and 'QCNoSSCD';
ii)     'QCSSCDStatusAsInCert' and 'QCWithSSCD';
iii)    'QCSSCDStatusAsInCert' and 'QCNoSSCD';
3)    the processing shall identify the presence of the 0.4.0.1456.1.1 (QCP+) ETSI defined certificate policy
OID in the CertificatePolicies extension and the presence of the QcSSCD statement in the QCStatements
extension (see ETSI EN 319 412-5 [3]) in CERT;
4)    the processing shall use the information obtained in above point PRO-4.5.4-03.(a).a. to select the
appropriate column of Table 6, and shall use the information obtained in above point PRO-4.5.4-03.(a).c.
to select the appropriate row of Table 6, and shall set QSCD-Results to the value found in the selected
cell;
Table 6: QSCD status check (Directive regime)
Sie:Q                                "QCSSCDStatusAsInCert"
"QCWithSSCD"                                                   “QCNoSSCD”
CERT                                                         or no indication
QcSSCD present
and/or PolicyId QCP+
QSCD_YES                       QSCD_YES                       QSCD_NO
(qcp-public-with-sscd)
present
QcSSCD not present
and PolicyId QCP+
QSCD_YES                       QSCD_NO                        QSCD_NO
(qcp-public-with-sscd)
not present
5)    the processing shall set QSCD-Status to the value "PROCESS_PASSED"; and
6)    the processing shall stop the process;
b)    the processing shall set QSCD-Results to the value "QSCD_INDETERMINATE";
c)     the processing shall set QSCD-Status to the value "PROCESS_PASSED"; and
d)     the processing shall stop the process.
PRO-4.5.4-04: If QC_Results includes the value "QC_For_eSig" or "QC_For_eSeal", then considering respectively
CHECK_1_SET-OF_QE or CHECK_2_SET-OF_QE as part of the outputs of the process run in PRO-4.5.4-01:
a)     the processing shall identify the set of all applicable qualifiers as per the content of the 'Qualifier' descendant
elements (see clause 5.5.9.2.3 of ETSI TS 119 612 [1]) of all 'QualificationElement' elements of the
considered output variable, and shall check whether the following qualifiers are present among them:
'QCWithQSCD' ("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCWithQSCD"), 'QCNoQSCD'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCNoQSCD"), 'QCQSCDStatusAsInCert'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCQSCDStatusAsInCert"), and
'QCQSCDManagedOnBehalf'
("http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/QCQSCDManagedOnBehalf");
b)     in case one of the applicable qualifiers is not known by the processing, then:
1)    if the 'Qualifications' extension from which this qualifier was retrieved is marked "critical", the
processing shall set QSCD-Status to the value "PROCESS_FAILED", shall add to
QSCD-Sub-Status the value "ERROR_Unknown_critical_qualifiers_for_QSCD_status", and shall
stop the process;
2)    else the processing shall add to QSCD-Sub-Status the value
"WARNING_Unknown_qualifiers_for_QSCD_status";

> NOTE:       The set of qualifiers that are known by the processing is implementation dependent. In the context of EU

qualified certificates, the set of qualifiers that can be used when the type of the service to which it applies
is "CA/QC" is specified in clause 5.5.9.2.3 of ETSI TS 119 612 [1].
c)     in case one of the following qualifier or combinations is found, the processing shall set QSCD-Results to
the value "QSCD_INDETERMINATE", shall set QSCD-Status to the value
"PROCESS_PASSED_WITH_WARNING", shall add to QSCD-Sub-Status the value
"WARNING_Inconsistency_in_applying_qualifiers_for_QSCD_status", and shall stop the process:
1)    'QCWithSSCD' and absence of 'QCWithQSCD';
2)    'QCNoSSCD' and absence of 'QCNoQSCD';
3)    'QCWithQSCD' and 'QCNoQSCD';
4)    'QCQSCDManagedOnBehalf' and 'QCNoQSCD';
5)    'QCQSCDStatusAsInCert' and any one of the other qualifiers listed in PRO-4.5.4-04.(a);
d)     the processing shall identify the presence of the QcSSCD statement in the QCStatements extension (see ETSI
EN 319 412-5 [3]) in CERT;
e)     the processing shall use the information obtained in above point PRO-4.5.4-04.(a) to select the appropriate
column of Table 7, shall use the information obtained in above point PRO-4.5.4-04.(c) to select the appropriate
row of Table 7, and shall set QSCD-Results to the value found in the selected cell.
Table 7: QSCD status check (Regulation regime)
Sie:Q        "QCWithQSCD"
"QCQSCDStatusAsInCert"
or                                                             "QCNoQSCD"
or no indication
CERT                          "QCQSCDManagedOnBehalf"
QcSSCD                      QSCD_YES                          QSCD_YES                          QSCD_NO
present
QcSSCD
not present
QSCD_YES                          QSCD_NO                           QSCD_NO
f)    the processing shall set QSCD-Status to the value "PROCESS_PASSED"; and
g)    the processing shall stop the process.
PRO-4.5.4-05: If QC_Results does not include the value "QC_For_eSig" nor the value "QC_For_eSeal" then:
a)    the processing shall set QSCD-Results to the value "QSCD_INDETERMINATE";
b)    the processing shall set QSCD-Status to the value "PROCESS_PASSED"; and
c)    the processing shall stop the process.

### 4.6 EU trust service token issuer qualification determination


#### 4.6.1 Description

The procedure specified in the present clause allows determining whether the signer identified in the certificate
supporting the validation of the digital signature of a trust service output is confirmed by the applicable EUMS trusted
list to have been, at a specific date and time, an EU qualified trust service provider for the provision of a qualified trust
service corresponding to the 'service type identifier' URI provided as input.

> NOTE:      The present process is only applicable when the qualified trust service provider providing a qualified

service is making use of PKI technology (e.g. for digitally signing evidences, attestations, reports) and the
related PKI certificate is published in the applicable EUMS trusted list.

#### 4.6.2 Inputs

Name                                                 Description of inputs
CERT                      X.509 certificate for which the information is to be obtained (e.g. a ds:X509Certificate
value of a ds:KeyInfo of the ds:Signature from the corresponding trust service
output).
Date-time                 Date and time indication as specified in clause 5.1.3 of ETSI TS 119 612 [1].
TLS-Sti                   A 'Service type identifier' URI value, taking one of the values specified in clause 5.5.1.1 of
ETSI TS 119 612 [1].

#### 4.6.3 Outputs

Name                                                            Description
QTSTo-Results             An indication of the EU qualified status of the QTSP/QTS identified through the subject
attribute of CERT, which is one of the following values:
a) "Not_Qualified" to indicate that the signer identified in the CERT is confirmed by
the applicable EUMS trusted list from CC to not have been, at Date-time, an EU
qualified trust service provider for the provision of the qualified trust service
corresponding to the URI provided as input in TLS-Sti;
b) "Qualified" to indicate that the signer identified in the CERT is confirmed by the
applicable EUMS trusted list from CC to have been, at Date-time, an EU
qualified trust service provider for the provision of the qualified trust service
corresponding to the URI provided as input in TLS-Sti;
c) "Indeterminate" to indicate that the EUMS trusted list from CC cannot be used to
confirm that the signer identified in the CERT has been, at Date-time, an EU
qualified trust service provider for the provision of the qualified trust service
corresponding to the URI provided as input in TLS-Sti.
QTSTo-Status              The status indication of the process.
QTSTo-Sub-Status          A list of indications supplementing the QTSTo-Status indication.
CC                        The country code of the EUMS trusted list being used to obtain the above listed three other
outputs.
TSP-Name                  A 'TSP name' element as defined in clause 5.4.1 of ETSI TS 119 612 [1].
OUT-4.6.3-01: All above listed output variables shall be initialized to void.

#### 4.6.4 Processing

PRO-4.6.4-01: If Date-time is before "2016-06-30T22:00:00Z", then:
a)    the processing shall set QTSTo-Status to the value "PROCESS_PASSED";
b)    the processing shall set QTSTo-Results to the set of values "Not_Qualified"; and
c)    the processing shall stop the process.
PRO-4.6.4-02: The processing shall set CC to the country code value of the countryName attribute of the subject
field of the certificate provided in CERT, in capital letters in accordance with the ISO 3166-1 [2] Alpha 2 country code
with, when applicable:
a)    the country code value "GB" being converted to "UK";
b)    the country code value "GR" being converted to "EL".
PRO-4.6.4-03: The processing shall run the process described in clause 4.3 of the present document, passing the
following inputs to the process:
a)    CERT;
b)    TLS-Sti;
c)    Date-time;
d)    CC.
PRO-4.6.4-04: If the output SI-Status of the process run in PRO-4.6.4-03 has the value "PROCESS_FAILED",
then:
a)    the processing shall set QTSTo-Status to the value "PROCESS_FAILED";
b)    the processing shall set QTSTo-Results to the value "Indeterminate";
c)    the processing shall set QTSTo-Sub-Status to the set of values from SI-Status and SI-Sub-
Status; and
d)    the processing shall stop the process.
PRO-4.6.4-05: If the output SI-Results of the process run in PRO-4.6.4-03 is void, then:
a)    the processing shall set QTSTo-Status to the value "PROCESS_PASSED";
b)    the processing shall set QTSTo-Results to the set of values "Not_Qualified"; and
c)    the processing shall stop the process.
PRO-4.6.4-06: If the output SI-Results of the process run in PRO-4.6.4-03 includes more than one tuple for which
the SI-at-Date-time respective parts include different values for their 'Service current status' or 'Service previous
status' field, then:
a)    the processing shall set QTSTo-Status to the value "PROCESS_FAILED";
b)    the processing shall set QTSTo-Results to the value "Indeterminate";
c)    the processing shall set QTSTo-Sub-Status to the value
"ERROR_INCONSISTENCY_IN_TL_ON_TSTO-CERT_STATUS"; and
d)    the processing shall stop the process.
PRO-4.6.4-07: If the output SI-Results of the process run in PRO-4.6.4-03 includes more than one tuple for which
the SI-at-Date-time respective parts include different public key values for their 'Service digital identifier' field
(see clause 5.5.3 of ETSI TS 119 612 [1]), then the processing shall add to QTSTo-Sub-Status the value
"WARNING_DUPLICATION_OF_SERVICE_INFORMATION_IN_TL_REGARDING_TSTO-CERT".
PRO-4.6.4-08: If the organizationName attribute of the subjectName field of the certificate provided in CERT
is not matching one of the values of TSP-Name or TSP-Trade-Name of the output SI-Results of the process run
in PRO-4.6.4-03, then:
a)    the processing shall set QTSTo-Status to the value "PROCESS_FAILED";
b)    the processing shall set QTSTo-Results to the value "Indeterminate";
c)    the processing shall set QTSTo-Sub-Status to the value
"ERROR_TSP_NAME_INCONSISTENCY_BETWEEN_TSTO-CERT_AND_TL"; and
d)    the processing shall stop the process.
PRO-4.6.4-09: If the 'Service current status' or 'Service previous status' field(s) of the SI-at-Date-time part(s) of
the output SI-Results of the process run in PRO-4.6.4-03 has the value
"http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/granted":
a)    then:
1)      the processing shall set QTSTo-Status to the value "PROCESS_PASSED";
2)      the processing shall set QTSTo-Results to the value "Qualified";
3)      the processing shall set TSP-Name the value TSP-Name of the output SI-Results; and
4)      the processing shall stop the process.
b)    else:
1)      the processing shall set QTSTo-Status to the value "PROCESS_PASSED";
2)      the processing shall set QTSTo-Results to the value "Not_Qualified";
3)      the processing shall set TSP-Name to the value TSP-Name of the output SI-Results; and
4)      the processing shall stop the process.

### 4.7 EU qualified time stamp determination


#### 4.7.1 Description

The procedure specified in clause 4.7 allows determining whether a time stamp token is confirmed by the applicable
EUMS trusted list to have been an EU qualified time stamp at its generation time, provided that the timestamp is valid.

#### 4.7.2 Inputs

Name                                                   Description of inputs
TST                       The time stamp token for which the information is to be obtained.
Date-time                 Date and time indication as specified in clause 5.1.3 of ETSI TS 119 612 [1].

#### 4.7.3 Outputs

Name                                                        Description
QTST-Results             An indication of the EU qualified status of TST through one of the following values:
a) "Not_Qualified" to indicate that TST is not an EU qualified time stamp according
to the EUMS trusted list from CC at Date-time;
b) "Qualified" to indicate that TST is an EU qualified time stamp according to the
EUMS trusted list from CC at Date-time;
c) "Indeterminate" to indicate that the EUMS trusted list from CC cannot be used to
confirm that TST is an EU qualified time stamp at Date-time.
QTST-Status              The status indication of the process.
QTST-Sub-Status          A list of indications supplementing QTST-Status indication.
CC                       The country code of the EUMS trusted list being used to obtain the above listed three other
outputs.
OUT-4.7.3-01: All above listed output variables shall be initialized to void.

#### 4.7.4 Processing

PRO-4.7.4-01: The processing shall set TLS-Sti to the value "http://uri.etsi.org/TrstSvc/Svctype/TSA/QTST" as
specified in clause 5.5.1.1 of ETSI TS 119 612 [1].
PRO-4.7.4-02: The processing shall run the process described in clause 4.6 of the present document, passing the
following inputs to the process:
a)    CERT;
b)    TLS-Sti;
c)    Date-time.
PRO-4.7.4-03: The processing shall:
a)    set QTST-Status to the same value from QTSTo-Status;
b)    set QTST-Results to the same value, or same set of values, as the value, or set of values, from QTSTo-
Results; and
c)    set QTST-Sub-Status to the set of values from QTSTo-Sub-Status.
PRO-4.7.4-04: The processing shall run the process described in clause 4.6 of the present document, passing the
following inputs to the process:
a)    CERT;
b)    TLS-Sti;
c)    the date and time value as specified in TST and expressed as specified in clause 5.1.3 of ETSI TS 119 612 [1].
EXAMPLE:          This date and time indication can be genTime from TSTInfo as specified in IETF
RFC 3161 [i.6].
PRO-4.7.4-05: If the output QTSTo-Status of the process run in PRO-4.7.4-04 has the value
"PROCESS_FAILED", then:
a)    the processing shall set QTST-Status to the value "PROCESS_FAILED";
b)    the processing shall add to QTST-Sub-Status the values provided by set of values from QTSTo-Status
and QTSTo-Sub-Status from the process run in PRO-4.7.4-04; and
c)    the processing shall stop the process.
PRO-4.7.4-06: The processing shall compare the values of QTST-Results obtained as a result of PRO-4.7.4-03 and
the values of QTSTo-Results obtained as a result of PRO-4.7.4-04:
a)    when the two results do not contain the exact same indication then:
1)    the processing shall set QTST-Status to the value "PROCESS_FAILED";
2)    the processing shall add to QTST-Sub-Status appropriate values reflecting the problematic
comparison(s); and
3)    the processing shall stop the process.

### 4.8 EU qualified validation service determination


#### 4.8.1 Description

The procedure specified in clause 4.8 allows determining whether the signer identified in the certificate supporting the
validation of the digital signature of a trust service output is confirmed by the applicable EUMS trusted list to have
been, at a specific date and time, an EU qualified trust service provider for the provision of a qualified validation
service for qualified electronic signatures and/or for the provision of a qualified validation service for qualified
electronic seals.

> NOTE:      The verification whether the trust service output is indeed a signature validation report attesting the result

of the validation process of an EU qualified electronic signature or of an EU qualified electronic seal is
out of scope of the present procedure.

#### 4.8.2 Inputs

Name                                                 Description of inputs
CERT                     X.509 certificate for which the information is to be obtained (e.g. a ds:X509Certificate
value of a ds:KeyInfo of the ds:Signature from the corresponding trust service
output).
Date-time                Date and time indication as specified in clause 5.1.3 of ETSI TS 119 612 [1].

#### 4.8.3 Outputs

Name                                                           Description
QVSO-Results             A set of indications of the EU qualified status of the QTSP/QTS identified through the
subject attribute of CERT, which contains one or more of the following values:
a) "Not_Qualified_For_eSig" to indicate that the signer identified in the CERT is
confirmed by the applicable EUMS trusted list from CC to not have been, at
Date-time, an EU qualified trust service provider for the provision of a qualified
validation service for qualified electronic signatures;
b) "Not_Qualified_For_eSeal" to indicate that the signer identified in the CERT is
confirmed by the applicable EUMS trusted list from CC to not have been, at
Date-time, an EU qualified trust service provider for the provision of a qualified
validation service for qualified electronic seals;
c) "Qualified_For_eSig" to indicate that the signer identified in the CERT is confirmed
by the applicable EUMS trusted list from CC to have been, at Date-time, an EU
qualified trust service provider for the provision of a qualified validation service for
qualified electronic signatures;
d) "Qualified_For_eSeal" to indicate that the signer identified in the CERT is
confirmed by the applicable EUMS trusted list from CC to have been, at
Date-time, an EU qualified trust service provider for the provision of a qualified
validation service for qualified electronic seals;
e) "Indeterminate" to indicate that the EUMS trusted list from CC cannot be used to
confirm that the signer identified in the CERT has been, at Date-time, an EU
qualified trust service provider for the provision of a qualified validation service for
qualified electronic signatures or for the provision of a qualified validation service
for qualified electronic seals.
QVSO-Status              The status indication of the process.
QVSO-Sub-Status          A list of indications supplementing QVSO-Status indication.
CC                       The country code of the EUMS trusted list being used to obtain the above listed three other
outputs.
OUT-4.8.3-01: All above listed output variables shall be initialized to void.

#### 4.8.4 Processing

PRO-4.8.4-01: The processing shall set TLS-Sti to the value "http://uri.etsi.org/TrstSvc/Svctype/QESValidation/Q"
as specified in clause 5.5.1.1 of ETSI TS 119 612 [1].
PRO-4.8.4-02: The processing shall run the process described in clause 4.6 of the present document, passing the
following inputs to the process:
a)    CERT;
b)    TLS-Sti;
c)    Date-time.
PRO-4.8.4-03: If the output QTSTo-Status of the process run in PRO-4.8.4-02 has the value
"PROCESS_FAILED", then:
a)    the processing shall set QVSO-Status to the value "PROCESS_FAILED";
b)    the processing shall set QVSO-Results to the same value, or same set of values, as the value, or set of
values, from QTSTo-Results;
c)    the processing shall set QVSO-Sub-Status to the same value, or same set of values, as the value, or set of
values, from QTSTo-Sub-Status; and
d)    the processing shall stop the process.
PRO-4.8.4-04: If the output QTSTo-Status of the process run in PRO-4.8.4-02 has the value "PROCESS_PASSED"
and the output QTSTo-Results has the value "Not_Qualified", then:
a)    the processing shall set QVSO-Status to the value "PROCESS_PASSED";
b)    the processing shall set QVSO-Results to the same value, or same set of values, as the value, or set of
values, from QTSTo-Sub-Status;
c)    the processing shall set QVSO-Results to the set of values "Not_Qualified_For_eSig" and
"Not_Qualified_For_eSeal"; and
d)    the processing shall stop the process.
PRO-4.8.4-05: If the output QTSTo-Status of the process run in PRO-4.8.4-02 has the value "PROCESS_PASSED"
and the output QTSTo-Results has the value "Qualified":
a)    then:
1)      the processing shall set QVSO-Status to the value "PROCESS_PASSED";
2)      if one of these SI-at-Date-time respective parts include an 'additionalServiceInformation'
extension (see clause 5.5.9.4 of ETSI TS 119 612 [1]) including the value
"http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForeSignatures":
i)    then the processing shall add to QVSO-Results the value "Qualified_For_eSig";
ii)   else the processing shall add to QVSO-Results the value "Not_Qualified_For_eSig";
3)      if one of these SI-at-Date-time respective parts include an 'additionalServiceInformation'
extension (see clause 5.5.9.4 of ETSI TS 119 612 [1]) including the value
"http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForeSeals":
i)    then the processing shall add to QVSO-Results the value "Qualified_For_eSeal";
ii)   else the processing shall add to QVSO-Results the value "Not_Qualified_For_eSeal"; and
4)      the processing shall stop the process;
b)    else:
1)      the processing shall set QVSO-Status to the value "PROCESS_PASSED";
2)      the processing shall set QVSO-Results to the set of values "Not_Qualified_For_eSig" and
"Not_Qualified_For_eSeal"; and
3)      the processing shall stop the process.

### 4.9 EU qualified preservation service determination


#### 4.9.1 Description

The procedure specified in clause 4.9 allows determining whether the signer identified in the certificate supporting the
validation of the digital signature of a trust service output is confirmed by the applicable EUMS trusted list to have
been, at a specific date and time, an EU qualified trust service provider for the provision of a qualified preservation
service for qualified electronic signatures and/or for the provision of a qualified preservation service for qualified
electronic seals.

> NOTE:         The present process is only applicable when the qualified trust service provider providing a qualified

preservation service for qualified electronic signatures and/or for qualified electronic seals is making use
of PKI technology (e.g. for digitally signing evidences, attestations, reports) and the related PKI
certificate is published in the applicable EUMS trusted list.

#### 4.9.2 Inputs

Name                                                 Description of inputs
CERT                     X.509 certificate for which the information is to be obtained (e.g. a ds:X509Certificate
value of a ds:KeyInfo of the ds:Signature from the corresponding trust service
output)
Date-time                Date and time indication as specified in clause 5.1.3 of ETSI TS 119 612 [1].

#### 4.9.3 Outputs

Name                                                          Description
QPSO-Results             A set of indications of the EU qualified status of the QTSP/QTS identified through the
subject attribute of CERT, which contains one or more of the following values:
a) "Not_Qualified_For_eSig" to indicate that the signer identified in the CERT is
confirmed by the applicable EUMS trusted list from CC to not have been, at
Date-time, an EU qualified trust service provider for the provision of a
qualified preservation service for qualified electronic signatures;
b) "Not_Qualified_For_eSeal" to indicate that the signer identified in the CERT is
confirmed by the applicable EUMS trusted list from CC to not have been, at
Date-time, an EU qualified trust service provider for the provision of a
qualified preservation service for qualified electronic seals;
c) "Qualified_For_eSig" to indicate that the signer identified in the CERT is
confirmed by the applicable EUMS trusted list from CC to have been, at
Date-time, an EU qualified trust service provider for the provision of a
qualified preservation service for qualified electronic signatures;
d) "Qualified_For_eSeal" to indicate that the signer identified in the CERT is
confirmed by the applicable EUMS trusted list from CC to have been, at
Date-time, an EU qualified trust service provider for the provision of a
qualified preservation service for qualified electronic seals;
e) "Indeterminate" to indicate that the EUMS trusted list from CC cannot be used to
confirm that the signer identified in the CERT has been, at Date-time, an EU
qualified trust service provider for the provision of a qualified preservation
service for qualified electronic signatures or for the provision of a qualified
preservation service for qualified electronic seals.
QPSO-Status              The status indication of the process.
QPSO-Sub-Status          A list of indications supplementing QPSO-Status indication.
CC                       The country code of the EUMS trusted list being used to obtain the above listed three other
outputs.
OUT-4.9.3-01: All above listed output variables shall be initialized to void.

#### 4.9.4 Processing

PRO-4.9.4-01: The processing shall set TLS-Sti to the value "http://uri.etsi.org/TrstSvc/Svctype/PSES/Q" as
specified in clause 5.5.1.1 of ETSI TS 119 612 [1].
PRO-4.9.4-02: The processing shall run the process described in clause 4.6 of the present document, passing the
following inputs to the process:
a)    CERT;
b)    TLS-Sti;
c)    Date-time.
PRO-4.9.4-03: If the output QTSTo-Status of the process run in PRO-4.9.4-02 has the value
"PROCESS_FAILED", then:
a)    the processing shall set QPSO-Status to the value "PROCESS_FAILED";
b)    the processing shall set QPSO-Results to the same value, or same set of values, as the value, or set of
values, from QTSTo-Results;
c)    the processing shall set QPSO-Sub-Status to the set of values from SI-QTSTo-Sub-Status; and
d)    the processing shall stop the process.
PRO-4.9.4-04: If the output QTSTo-Status of the process run in PRO-4.9.4-02 has the value "PROCESS_PASSED"
and the output QTSTo-Results has the value "Not_Qualified", then:
a)    the processing shall set QPSO-Status to the value "PROCESS_PASSED";
b)    the processing shall set QPSO-Results to the set of values "Not_Qualified_For_eSig" and
"Not_Qualified_For_eSeal"; and
c)    the processing shall stop the process.
PRO-4.9.4-05: If the output QTSTo-Status of the process run in PRO-4.9.4-02 has the value "PROCESS_PASSED"
and the output QTSTo-Results has the value "Qualified":
a)    then:
1)      the processing shall set QPSO-Status to the value "PROCESS_PASSED";
2)      if one of these SI-at-Date-time respective parts include an 'additionalServiceInformation'
extension (see clause 5.5.9.4 of ETSI TS 119 612 [1]) including the value
"http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForeSignatures":
i)    then the processing shall add to QPSO-Results the value "Qualified_For_eSig";
ii)   else the processing shall add to QPSO-Results the value "Not_Qualified_For_eSig";
3)      if one of these SI-at-Date-time respective parts include an 'additionalServiceInformation'
extension (see clause 5.5.9.4 of ETSI TS 119 612 [1]) including the value
"http://uri.etsi.org/TrstSvc/TrustedList/SvcInfoExt/ForeSeals":
i)    then the processing shall add to QPSO-Results the value "Qualified_For_eSeal";
ii)   else the processing shall add to QPSO-Results the value "Not_Qualified_For_eSeal"; and
4)      the processing shall stop the process;
b)    else:
1)      the processing shall set QPSO-Status to the value "PROCESS_PASSED";
2)      the processing shall set QPSO-Results to the set of values "Not_Qualified_For_eSig" and
"Not_Qualified_For_eSeal"; and
3)      the processing shall stop the process.

### 4.10 EU qualified electronic registered delivery service

determination

#### 4.10.1 Description

The procedure specified in clause 4.10 allows determining whether the signer identified in the certificate supporting the
validation of the digital signature of a trust service output is confirmed by the applicable EUMS trusted list to have
been, at a specific date and time, an EU qualified trust service provider for the provision of a qualified electronic
registered delivery service.

> NOTE:         The verification whether the trust service output is indeed a qualified electronic registered delivery

service evidence or statement is out of scope of the present procedure.

#### 4.10.2 Inputs and parameters

Name                                                 Description of inputs
CERT                     X.509 certificate for which the information is to be obtained (e.g. a ds:X509Certificate
value of a ds:KeyInfo of the ds:Signature from the corresponding trust service
output).
Date-time                A date and time indication as specified in clause 5.1.3 of ETSI TS 119 612 [1].

#### 4.10.3 Outputs

Name                                                          Description
QERDSO-Results             An indication of the EU qualified status of the QTSP/QTS identified through the subject
attribute of CERT, which is one of the following values:
a) "Not_Qualified" to indicate that the signer identified in the CERT is confirmed by
the applicable EUMS trusted list from CC to not have been, at Date-time, an
EU qualified trust service provider for the provision of a qualified electronic
registered delivery service;
b) "Qualified" to indicate that the signer identified in the CERT is confirmed by the
applicable EUMS trusted list from CC to have been, at Date-time, an EU
qualified trust service provider for the provision of a qualified electronic
registered delivery service;
c) "Indeterminate" to indicate that the EUMS trusted list from CC cannot be used to
confirm that the signer identified in the CERT has been, at Date-time, an EU
qualified trust service provider for the provision of a qualified electronic
registered delivery service.
QERDSO-Status              The status indication of the process.
QERDSO-Sub-Status          A list of indications supplementing QERDSO-Status indication.
CC                         The country code of the EUMS trusted list being used to obtain the above listed three
other outputs.
OUT-4.10.3-01: All above listed output variables shall be initialized to void.

#### 4.10.4 Processing

PRO-4.10.4-01: The processing shall set TLS-Sti-1 to the value "http://uri.etsi.org/TrstSvc/Svctype/EDS/Q" as
specified in clause 5.5.1.1 of ETSI TS 119 612 [1].
PRO-4.10.4-02: The processing shall set TLS-Sti-2 to the value "http://uri.etsi.org/TrstSvc/Svctype/EDS/REM/Q"
as specified in clause 5.5.1.1 of ETSI TS 119 612 [1].
PRO-4.10.4-03: The processing shall run the process described in clause 4.6 of the present document, passing the
following inputs to the process:
a)    CERT;
b)    TLS-Sti-1;
c)    Date-time.
PRO-4.10.4-04: The processing shall run the process described in clause 4.6 of the present document, passing the
following inputs to the process:
a)    CERT;
b)    TLS-Sti-2;
c)    Date-time.
PRO-4.10.4-05: If one of the outputs QTSTo-Status of the processes run in PRO-4.10.4-03 and in PRO-4.10.4-04
has the value "PROCESS_FAILED", then:
a)    the processing shall set QERDSO-Status to the value "PROCESS_FAILED";
b)    the processing shall set QERDSO-Results to the set of values from QTSTo-Results of both processes;
c)    the processing shall set QERDSO-Sub-Status to the set of values from QTSTo-Sub-Status of both
processes; and
d)    the processing shall stop the process.
PRO-4.10.4-06: If both outputs QTSTo-Status of the processes run in PRO-4.10.4-03 and in PRO-4.10.4-04 have
the value "PROCESS_PASSED" and both corresponding outputs QTSTo-Results have the value "Not_Qualified",
then:
a)    the processing shall set QERDSO-Status to the value "PROCESS_PASSED";
b)    the processing shall set QERDSO-Results to the value "Not_Qualified"; and
c)    the processing shall stop the process.
PRO-4.10.4-07: When the outputs TSP-Name from the processes run in PRO-4.10.4-03 and in PRO-4.10.4-04 have
different values, then:
a)    the processing shall add to QERDSO-Sub-Status the indication value "ERROR_TSP_CONFLICT";
b)    the processing shall set QERDSO-Results to the value "Indeterminate";
c)    the processing shall set QERDSO-Status to the value "PROCESS_FAILED"; and
d)    the processing shall stop the process.
PRO-4.10.4-08: If the output QTSTo-Status of both of the process run in PRO-4.10.4-03 and in PRO-4.10.4-04 has
the value "PROCESS_PASSED" and the output QTSTo-Results of any of those two processes has the value
"Qualified":
a)    then:
1)      the processing shall set QERDSO-Status to the value "PROCESS_PASSED";
2)      the processing shall set QERDSO-Results to the value "Qualified"; and
3)      the processing shall stop the process;
b)    else:
1)      the processing shall set QERDSO-Status to the value "PROCESS_PASSED";
2)      the processing shall set QERDSO-Results to the value "Not_Qualified"; and
3)      the processing shall stop the process.

### 4.11 EU qualified archiving service determination


#### 4.11.1 Description

The procedure specified in clause 4.11 allows determining whether the signer identified in the certificate supporting the
validation of the digital signature of a trust service output (e.g. the signature of the report of an electronic archiving
service) is confirmed by the applicable EUMS trusted list to have been, at a specific date and time, an EU qualified trust
service provider for the provision of a qualified archiving service.

> NOTE:         The present process is only applicable when the qualified trust service provider providing a qualified

archiving service for qualified electronic signatures and/or for qualified electronic seals is making use of
PKI technology (e.g. for digitally signing evidences, attestations, reports) and the related PKI certificate is
published in the applicable EUMS trusted list.

#### 4.11.2 Inputs

Name                                                   Description of inputs
CERT                       X.509 certificate for which the information is to be obtained (e.g. a ds:X509Certificate
value of a ds:KeyInfo of the ds:Signature from the corresponding trust service
output)
Date-time                  Date and time indication as specified in clause 5.1.3 of ETSI TS 119 612 [1].

#### 4.11.3 Outputs

Name                                                             Description
QARCH-Results              An indication of the EU qualified status of the QTSP/QTS identified through the subject
attribute of CERT, which is one of the following values:
a) "Not_Qualified" to indicate that the signer identified in the CERT is confirmed by
the applicable EUMS trusted list from CC to not have been, at Date-time, an EU
qualified trust service provider for the provision of a qualified electronic archiving
service;
b) "Qualified" to indicate that the signer identified in the CERT is confirmed by the
applicable EUMS trusted list from CC to have been, at Date-time, an EU
qualified trust service provider for the provision of a qualified electronic archiving
service;
c) "Indeterminate" to indicate that the EUMS trusted list from CC cannot be used to
confirm that the signer identified in the CERT has been, at Date-time, an EU
qualified trust service provider for the provision of a qualified electronic archiving
service.
QARCH-Status               The status indication of the process.
QARCH-Sub-Status           A list of indications supplementing the QARCH-Status indication.
CC                         The country code of the EUMS trusted list being used to obtain the above listed three other
outputs.
OUT-4.11.3-01: All above listed output variables shall be initialized to void.

#### 4.11.4 Processing

PRO-4.11.4-01: The processing shall set TLS-Sti to the value
"http://uri.etsi.org/TrstSvc/Svctype/ElectronicArchiving/Q" as specified in clause 5.5.1.1 of ETSI TS 119 612 [1].
PRO-4.11.4-02: The processing shall run the process described in clause 4.6 of the present document, passing the
following inputs to the process:
a)    CERT;
b)    TLS-Sti;
c)    Date-time.
PRO-4.11.4-03: The processing shall:
a)    set QARCH-Status to the same value from QTSTo-Status;
b)    set QARCH-Results to the same value, or same set of values, as the value, or set of values, from
QTSTo-Results;
c)    set QARCH-Sub-Status to the set of values from QTSTo-Sub-Status; and
d)    stop the process.

### 4.12 EU qualified electronic attestation of attribute service

determination

#### 4.12.1 Description

The procedure specified in clause 4.12 allows determining whether an electronic attestation of attribute is confirmed by
the applicable EUMS trusted list to have been an EU qualified electronic attestation of attribute at its generation time,
provided that the electronic attestation of attribute is valid.

#### 4.12.2 Inputs

Name                                                    Description of inputs
EAA                      The electronic attestation of attribute for which the information is to be obtained.
Date-time                Date and time indication as specified in clause 5.1.3 of ETSI TS 119 612 [1].

#### 4.12.3 Outputs

Name                                                        Description
QEAA-Results             An indication of the EU qualified status of TST through one of the following values:
a) "Not_Qualified" to indicate that EAA is not an EU qualified electronic attestation of
attribute according to the EUMS trusted list from CC at Date-time;
b) "Qualified" to indicate that EAA is an EU qualified electronic attestation of attribute
according to the EUMS trusted list from CC at Date-time;
c) "Indeterminate" to indicate that the EUMS trusted list from CC cannot be used to
confirm that EAA is an EU qualified electronic attestation of attribute at
Date-time.
QEAA-Status              The status indication of the process.
QEAA-Sub-Status          A list of indications supplementing QEAA-Status indication.
CC                       The country code of the EUMS trusted list being used to obtain the above listed three other
outputs.
OUT-4.12.3-01: All above listed output variables shall be initialized to void.

#### 4.12.4 Processing

PRO-4.12.4-01: The processing shall set TLS-Sti to the value "http://uri.etsi.org/TrstSvc/Svctype/EAA/Q" as
specified in clause 5.5.1.1 of ETSI TS 119 612 [1].
PRO-4.12.4-02: The processing shall set CERT to the X.509 certificate supporting the validation of the digital
signature on EAA.
PRO-4.12.4-03: The processing shall check whether the URN 'urn:etsi:eaa:eu:qualified' is present within
the content of EAA and if this URN is not present, then:
a)    the processing shall set QEAA-Status to the value "PROCESS_FAILED";
b)    the processing shall set QEAA-Results to the value "Indeterminate";
c)    the processing shall set QEAA-Sub-Status to the value
"ERROR_NO_ETSI_QEAA_TYPE_INDICATION_FOUND"; and
d)    the processing shall stop the process.
PRO-4.12.4-04: If the URN 'urn:etsi:eaa:eu:qualified' was found in the content of EAA as a result of
PRO-4.12.4-03, then the processing shall run the process described in clause 4.6 of the present document, passing the
following inputs to the process:
a)    CERT;
b)    TLS-Sti;
c)    Date-time.
PRO-4.12.4-05: The processing shall:
a)    set QEAA-Status to the same value from QTSTo-Status;
b)    set QEAA-Results to the same value, or same set of values, as the value, or set of values, from
QTSTo-Results;
c)    set QEAA-Sub-Status to the set of values from QTSTo-Sub-Status; and
d)    stop the process.

### 4.13 EU qualified ledger service determination


#### 4.13.1 Description

The procedure specified in clause 4.13 allows determining whether the signer identified in the certificate supporting the
validation of the digital signature of a record on a ledger is confirmed by the applicable EUMS trusted list to have been,
at a specific date and time, an EU qualified trust service provider for the provision of a qualified service for the
recording of electronic data in qualified electronic ledgers.

> NOTE:      The present process is only applicable when the qualified trust service provider providing a qualified

service for the recording of electronic data in qualified electronic ledgers is making use of PKI
technology (e.g. for digitally signing ledger records) and the related PKI certificate is published in the
applicable EUMS trusted list.

#### 4.13.2 Inputs

Name                                                   Description of inputs
CERT                       X.509 certificate for which the information is to be obtained (e.g. a ds:X509Certificate
value of a ds:KeyInfo of the ds:Signature from the corresponding trust service
output)
Date-time                  Date and time indication as specified in clause 5.1.3 of ETSI TS 119 612 [1].

#### 4.13.3 Outputs

Name                                                             Description
QLEDG-Results              An indication of the EU qualified status of the QTSP/QTS identified through the subject
attribute of CERT, which is one of the following values:
a) "Not_Qualified" to indicate that the signer identified in the CERT is confirmed by
the applicable EUMS trusted list from CC to not have been, at Date-time, an EU
qualified trust service provider for the provision of a qualified service for the
recording of electronic data in qualified electronic ledgers;
b) "Qualified" to indicate that the signer identified in the CERT is confirmed by the
applicable EUMS trusted list from CC to have been, at Date-time, an EU
qualified trust service provider for the provision of a qualified service for the
recording of electronic data in qualified electronic ledgers;
c) "Indeterminate" to indicate that the EUMS trusted list from CC cannot be used to
confirm that the signer identified in the CERT has been, at Date-time, an EU
qualified trust service provider for the provision of a service for the recording of
electronic data in qualified electronic ledgers.
QLEDG-Status               The status indication of the process.
QLEDG-Sub-Status           A list of indications supplementing the QLEDG-Status indication.
CC                         The country code of the EUMS trusted list being used to obtain the above listed three other
outputs.
OUT-4.13.3-01: All above listed output variables shall be initialized to void.

#### 4.13.4 Processing

PRO-4.13.4-01: The processing shall set TLS-Sti to the value "http://uri.etsi.org/TrstSvc/Svctype/Ledgers/Q" as
specified in clause 5.5.1.1 of ETSI TS 119 612 [1].
PRO-4.13.4-02: The processing shall run the process described in clause 4.6 of the present document, passing the
following inputs to the process:
a)    CERT;
b)    TLS-Sti;
c)    Date-time.
PRO-4.13.4-03: The processing shall:
a)    set QLEG-Status to the same value from QTSTo-Status;
b)    set QLEDG-Results to the same value, or same set of values, as the value, or set of values, from
QTSTo-Results;
c)    set QLEDG-Sub-Status to the set of values from QTSTo-Sub-Status; and
d)    stop the process.
New status                                                 Previous statuses
TST                        The time stamp token for which the information is to be obtained.
Date-time                  Date and time indication as specified in clause 5.1.3 of ETSI TS 119 612 [1].
Annex A (informative):
Bibliography
CEF eSignature - eIDAS Technical Subgroup and web conference on eSignature: "Reaching relying parties after a
change of LOTL Administrative Anchors".
Annex B (normative):
Output sub-statuses changes
In version 1.2.1 of the present document, the possible set of values for the output statuses QTST-Sub-Status,
QVSO-Sub-Status, QPSO-Sub-Status and QERDSO-Sub-Status were different for the processes specified
in clause 4.7 to clause 4.10 of the present document.
Table B.1 provides a mapping of the previous sub-status values to the new values.
Table B.1
Outputs                     Previous statuses                  New statuses
QTST-Sub-Status         ERROR_INCONSISTENCY_IN_TL_ON_TS ERROR_INCONSISTENCY_IN_TL_ON_TSTO
T_STATUS                        -CERT_STATUS
QVSO-Sub-Status         ERROR_INCONSISTENCY_IN_TL_ON_VS
O-CERT_STATUS
QPSO-Sub-Status   ERROR_INCONSISTENCY_IN_TL_ON_PS
O-CERT_STATUS
QERDSO-Sub-Status ERROR_INCONSISTENCY_IN_TL_ON_ER
DS_CERT_STATUS
QTST-Sub-Status   WARNING_DUPLICATION_OF_SERVICE_                     WARNING_DUPLICATION_OF_SERVICE_INF
INFORMATION_IN_TL_REGARDING_TST                     ORMATION_IN_TL_REGARDING_TSTO-
QVSO-Sub-Status   WARNING_DUPLICATION_OF_SERVICE_                     CERT
INFORMATION_IN_TL_REGARDING_VSO
-CERT
QPSO-Sub-Status   WARNING_DUPLICATION_OF_SERVICE_
INFORMATION_IN_TL_REGARDING_PSO
-CERT
QERDSO-Sub-Status WARNING_DUPLICATION_OF_SERVICE_
INFORMATION_IN_TL_REGARDING_ERD
S_CERT
QTST-Sub-Status   ERROR_TSP_NAME_INCONSISTENCY_B                      ERROR_TSP_NAME_INCONSISTENCY_BET
QVSO-Sub-Status   ETWEEN_CERT_AND_TL                                  WEEN_TSTO-CERT_AND_TL
QPSO-Sub-Status
QERDSO-Sub-Status ERROR_TSP_NAME_INCONSISTENCY_B
ETWEEN_ERDS_CERT_AND_TL
Annex C (informative):
Change history
Date   Version                               Information about changes
May 2021     V1.1.1 Publication
CR#1 Fix of trust anchor usage when obtaining listed services matching a certificate
CR#2 Fix of qualification determination of pre-eIDAS certificates at post-eIDAS times
CR#3 Fix of pre-eIDAS status at post-eIDAS times
CR#4 Fix of conflicting information between 'additionalServiceInformation' and
May 2023     V1.2.1 'Qualification' extensions
CR#5 Fix of unexpected qualifiers for S/QSCDs
CR#6 Fix of timestamp qualification determination
CR#7 Fix wording on RFC 5280 processing
CR#8 Fix normative requirement in note
CR#01_019615: New TSTo issuer qualification determination process
CR#02_019615 Refactoring of previous processes for qualified trust token determination
June 2025    V1.3.1
CR#03_019615 New processes for the determination of the qualified status of the new
qualified trust services
History
Version        Date                           Status
V1.1.1      May 2021       Publication
V1.2.1      June 2023      Publication
V1.3.1      January 2026   Publication
